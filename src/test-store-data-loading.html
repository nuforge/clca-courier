<!-- Test page to verify the updated store functionality -->
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Store Test - Issues and Data Loading</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
      }
      .section {
        margin-bottom: 30px;
        padding: 20px;
        border: 1px solid #ddd;
        border-radius: 8px;
      }
      .loading {
        color: #666;
        font-style: italic;
      }
      .error {
        color: red;
      }
      .success {
        color: green;
      }
      .issue-item {
        margin: 10px 0;
        padding: 10px;
        background: #f5f5f5;
        border-radius: 4px;
      }
      ul {
        list-style-type: none;
        padding: 0;
      }
      li {
        margin: 5px 0;
      }
    </style>
  </head>
  <body>
    <h1>Site Store Simple - Data Loading Test</h1>
    <p>
      This page tests the updated site store that loads data from JSON files and includes all issues
      from the public/issues directory.
    </p>

    <div class="section">
      <h2>Store Loading Status</h2>
      <div id="loading-status" class="loading">Initializing store...</div>
    </div>

    <div class="section">
      <h2>Archived Issues (All Files from public/issues/)</h2>
      <div id="issues-content">Loading...</div>
    </div>

    <div class="section">
      <h2>News Items</h2>
      <div id="news-content">Loading...</div>
    </div>

    <div class="section">
      <h2>Events</h2>
      <div id="events-content">Loading...</div>
    </div>

    <div class="section">
      <h2>Classifieds</h2>
      <div id="classifieds-content">Loading...</div>
    </div>

    <div class="section">
      <h2>Community Stats</h2>
      <div id="stats-content">Loading...</div>
    </div>

    <script type="module">
      // This would normally use the actual Vue/Pinia store
      // For this test, we'll directly test the data service
      import { dataService } from './src/services/data-service.js';

      async function testDataLoading() {
        const loadingStatus = document.getElementById('loading-status');

        try {
          loadingStatus.textContent = 'Loading data...';
          loadingStatus.className = 'loading';

          // Test all data loading functions
          const [issues, news, events, classifieds, stats] = await Promise.all([
            dataService.getArchivedIssues(),
            dataService.getNewsItems(),
            dataService.getEvents(),
            dataService.getClassifieds(),
            dataService.getCommunityStats(),
          ]);

          // Update loading status
          loadingStatus.textContent = 'Data loaded successfully!';
          loadingStatus.className = 'success';

          // Display issues
          const issuesContent = document.getElementById('issues-content');
          issuesContent.innerHTML = `
                    <p><strong>Total Issues:</strong> ${issues.length}</p>
                    <ul>
                        ${issues
                          .map(
                            (issue) => `
                            <li class="issue-item">
                                <strong>${issue.title}</strong> (${issue.date})<br>
                                Pages: ${issue.pages}, File: ${issue.filename}
                            </li>
                        `,
                          )
                          .join('')}
                    </ul>
                `;

          // Display news
          const newsContent = document.getElementById('news-content');
          newsContent.innerHTML = `
                    <p><strong>Total News Items:</strong> ${news.length}</p>
                    <ul>
                        ${news
                          .slice(0, 3)
                          .map(
                            (item) => `
                            <li><strong>${item.title}</strong> - ${item.date} (${item.category})</li>
                        `,
                          )
                          .join('')}
                    </ul>
                `;

          // Display events
          const eventsContent = document.getElementById('events-content');
          eventsContent.innerHTML = `
                    <p><strong>Total Events:</strong> ${events.length}</p>
                    <ul>
                        ${events
                          .slice(0, 3)
                          .map(
                            (event) => `
                            <li><strong>${event.title}</strong> - ${event.date} at ${event.time}</li>
                        `,
                          )
                          .join('')}
                    </ul>
                `;

          // Display classifieds
          const classifiedsContent = document.getElementById('classifieds-content');
          classifiedsContent.innerHTML = `
                    <p><strong>Total Classifieds:</strong> ${classifieds.length}</p>
                    <ul>
                        ${classifieds
                          .slice(0, 3)
                          .map(
                            (item) => `
                            <li><strong>${item.title}</strong> - ${item.category} (${item.datePosted})</li>
                        `,
                          )
                          .join('')}
                    </ul>
                `;

          // Display stats
          const statsContent = document.getElementById('stats-content');
          statsContent.innerHTML = `
                    <ul>
                        <li><strong>Households:</strong> ${stats.households}</li>
                        <li><strong>Lakes:</strong> ${stats.lakes}</li>
                        <li><strong>Years Published:</strong> ${stats.yearsPublished}</li>
                        <li><strong>Issues Per Year:</strong> ${stats.issuesPerYear}</li>
                    </ul>
                `;
        } catch (error) {
          loadingStatus.textContent = `Error loading data: ${error.message}`;
          loadingStatus.className = 'error';
          console.error('Data loading error:', error);
        }
      }

      // Start the test
      testDataLoading();
    </script>
  </body>
</html>
