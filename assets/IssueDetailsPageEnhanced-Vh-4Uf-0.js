import{k as H,aw as te,ax as ae,c as p,h as L,N as h,G as le,ay as ie,az as oe,aA as ne,n as re,d as W,aB as X,I as _,J as o,a6 as P,K as k,M as s,a5 as a,f as e,P as v,a4 as x,a3 as m,a7 as N,a2 as f,aj as ue,aC as O,R as z,r as T,o as de,w as ce,aa as A,F as me,a9 as fe,aD as ve}from"./index-WAZpiL6p.js";import{Q as V}from"./QSpinnerDots-DbD4BrjI.js";import{Q as J}from"./QChip-DvKKwpRo.js";import{Q as G,u as pe}from"./useDynamicGoogleDriveIssues-CJ9zXfpy.js";import{Q as R,a as I,b as Q}from"./QItem-EHy2jVcG.js";import{Q as ge}from"./QList-B1UmnzKi.js";import{Q as _e}from"./QPage-CRV1LXMZ.js";import{u as Y}from"./site-store-simple-BnFZhcbF.js";import{u as Z}from"./usePdfViewer-_W0lU-g9.js";import{Q as he}from"./QSpace-DinSJI12.js";import{Q as K}from"./QTooltip-DLJz-SB9.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useUserSettings-DbiFVqxl.js";import"./use-quasar-DCLah36D.js";import"./pdf-ZhLmi4kS.js";import"./position-engine-BGdTm09t.js";import"./selection-DmVi8G6u.js";const E=H({name:"QBreadcrumbsEl",props:{...te,label:String,icon:String,tag:{type:String,default:"span"}},emits:["click"],setup(r,{slots:b}){const{linkTag:u,linkAttrs:D,linkClass:d,navigateOnClick:S}=ae(),q=p(()=>({class:"q-breadcrumbs__el q-link flex inline items-center relative-position "+(r.disable!==!0?"q-link--focusable"+d.value:"q-breadcrumbs__el--disable"),...D.value,onClick:S})),t=p(()=>"q-breadcrumbs__el-icon"+(r.label!==void 0?" q-breadcrumbs__el-icon--with-label":""));return()=>{const c=[];return r.icon!==void 0&&c.push(L(h,{class:t.value,name:r.icon})),r.label!==void 0&&c.push(r.label),L(u.value,{...q.value},le(b.default,c))}}}),be=["",!0],ye=H({name:"QBreadcrumbs",props:{...ie,separator:{type:String,default:"/"},separatorColor:String,activeColor:{type:String,default:"primary"},gutter:{type:String,validator:r=>["none","xs","sm","md","lg","xl"].includes(r),default:"sm"}},setup(r,{slots:b}){const u=oe(r),D=p(()=>`flex items-center ${u.value}${r.gutter==="none"?"":` q-gutter-${r.gutter}`}`),d=p(()=>r.separatorColor?` text-${r.separatorColor}`:""),S=p(()=>` text-${r.activeColor}`);return()=>{if(b.default===void 0)return;const q=ne(re(b.default));if(q.length===0)return;let t=1;const c=[],$=q.filter(g=>g.type?.name==="QBreadcrumbsEl").length,M=b.separator!==void 0?b.separator:()=>r.separator;return q.forEach(g=>{if(g.type?.name==="QBreadcrumbsEl"){const w=t<$,C=g.props!==null&&be.includes(g.props.disable),B=(w===!0?"":" q-breadcrumbs--last")+(C!==!0&&w===!0?S.value:"");t++,c.push(L("div",{class:`flex items-center${B}`},[g])),w===!0&&c.push(L("div",{class:"q-breadcrumbs__separator"+d.value},M()))}else c.push(g)}),L("div",{class:"q-breadcrumbs"},[L("div",{class:D.value},c)])}}}),xe={class:"relative"},ke={class:"thumbnail-container",style:{"aspect-ratio":"210/297",background:"#f5f5f5"}},qe={key:0,class:"flex items-center justify-center h-full"},we={key:1,class:"flex flex-col items-center justify-center h-full text-grey-6"},Ce={class:"text-caption mt-2 text-center px-2"},De={class:"text-subtitle2 mb-1",style:{"padding-right":"80px","line-height":"1.3"}},Se={class:"flex items-center gap-1 mb-1"},Ie={key:0,class:"flex items-center gap-1 mb-1"},Qe={key:1,class:"flex items-center gap-1 mb-1"},ze={key:2,class:"flex items-center gap-1 mb-1"},$e={class:"line-clamp-1"},Me={key:3,class:"flex items-center gap-1"},Be=W({__name:"GoogleDriveIssueCard",props:{issue:{},thumbnail:{},isLoading:{type:Boolean},showMetadata:{type:Boolean,default:!1}},emits:["regenerate-thumbnail"],setup(r,{emit:b}){const u=r,D=b,d=X(),S=Y(),{openDocument:q}=Z(),t=p(()=>S.isDarkMode?"bg-dark text-white q-dark":"bg-white text-dark"),c=p(()=>S.isDarkMode?"text-grey-4":"text-grey-7"),$=p(()=>{switch(u.issue.syncStatus){case"synced":return"positive";case"syncing":return"warning";case"error":return"negative";case"outdated":return"orange";default:return"grey"}}),M=p(()=>{switch(u.issue.syncStatus){case"synced":return"mdi-cloud-check";case"syncing":return"mdi-cloud-sync";case"error":return"mdi-cloud-alert";case"outdated":return"mdi-cloud-refresh";default:return"mdi-cloud"}}),g=i=>{try{return new Date(i).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return i}};function w(){d.push(`/archive/${u.issue.id}`)}function C(i){i.stopPropagation();const y={id:u.issue.id,title:u.issue.title,date:u.issue.date,pages:u.issue.pages,url:u.issue.googleDriveUrl||u.issue.localUrl||u.issue.url||"",filename:u.issue.filename};q(y)}function B(i){i.stopPropagation(),D("regenerate-thumbnail",u.issue,i)}return(i,y)=>(o(),_(P,{class:k([t.value,"issue-card cursor-pointer transition-all duration-300 hover:shadow-lg"]),onClick:w},{default:s(()=>[a("div",xe,[e(N,{class:"q-pa-none"},{default:s(()=>[a("div",ke,[i.isLoading?(o(),x("div",qe,[e(V,{size:"40px",color:"primary"})])):(o(),x("div",we,[e(h,{name:"mdi-file-pdf-box",size:"48px"}),a("div",Ce,m(i.issue.filename),1)]))])]),_:1}),i.showMetadata?(o(),_(G,{key:0,color:$.value,class:"absolute top-2 left-2",icon:M.value},{default:s(()=>[f(m(i.issue.syncStatus),1)]),_:1},8,["color","icon"])):v("",!0)]),e(N,{class:"q-pa-sm"},{default:s(()=>[a("div",De,m(i.issue.title),1),a("div",{class:k([c.value,"text-caption mb-2"])},m(g(i.issue.date)),3),i.showMetadata?(o(),x("div",{key:0,class:k(["text-caption",c.value])},[a("div",Se,[e(h,{name:"mdi-file-document",size:"12px"}),a("span",null,m(i.issue.pages)+" pages",1)]),i.issue.fileSize?(o(),x("div",Ie,[e(h,{name:"mdi-harddisk",size:"12px"}),a("span",null,m(i.issue.fileSize),1)])):v("",!0),i.issue.lastModified?(o(),x("div",Qe,[e(h,{name:"mdi-clock",size:"12px"}),a("span",null,"Modified "+m(g(i.issue.lastModified)),1)])):v("",!0),i.issue.description?(o(),x("div",ze,[e(h,{name:"mdi-information",size:"12px"}),a("span",$e,m(i.issue.description),1)])):v("",!0),i.issue.status==="google-drive"?(o(),x("div",Me,[e(h,{name:"mdi-google-drive",size:"12px"}),y[0]||(y[0]=a("span",null,"Google Drive",-1))])):v("",!0)],2)):v("",!0)]),_:1}),i.showMetadata?v("",!0):(o(),_(ue,{key:0,class:"q-pa-sm q-pt-none"},{default:s(()=>[e(z,{flat:"",size:"sm",color:"primary",icon:"mdi-eye",label:"View Details",class:"text-xs",onClick:O(w,["stop"])}),e(he),e(z,{flat:"",size:"sm",color:"grey-7",icon:"mdi-refresh",onClick:O(B,["stop"])},{default:s(()=>[e(K,null,{default:s(()=>y[1]||(y[1]=[f("Regenerate thumbnail",-1)])),_:1,__:[1]})]),_:1}),e(z,{flat:"",size:"sm",color:"primary",icon:"mdi-file-pdf-box",onClick:C},{default:s(()=>[e(K,null,{default:s(()=>y[2]||(y[2]=[f("Open PDF",-1)])),_:1,__:[2]})]),_:1})]),_:1}))]),_:1},8,["class"]))}}),Pe=ee(Be,[["__scopeId","data-v-4db1297c"]]),Le={class:"q-pa-md"},Fe={class:"row justify-center"},Ne={class:"col-12 col-lg-10"},Re={key:2,class:"row q-col-gutter-lg"},Te={class:"col-12 col-md-8"},Ae={class:"row q-col-gutter-md"},Ee={class:"col-12 col-sm-4"},Ve={class:"thumbnail-large",style:{"aspect-ratio":"210/297","max-width":"300px"}},Ge={class:"flex flex-col items-center justify-center h-full bg-grey-2 rounded"},Ue={class:"q-mt-md"},je={class:"col-12 col-sm-8"},Oe={class:"text-h4 q-mb-md"},Je={class:"row q-col-gutter-md q-mb-lg"},Ke={class:"col-6"},He={class:"col-6"},We={class:"q-mb-lg"},Xe={class:"row q-col-gutter-sm"},Ye={class:"col-auto"},Ze={class:"col-auto"},es={key:0,class:"q-mb-lg"},ss={key:1,class:"text-center q-py-md"},ts={class:"col-12 col-md-4"},as={class:"q-gutter-md"},ls=W({__name:"IssueDetailsPageEnhanced",setup(r){const b=ve(),u=X(),D=Y(),d=pe(),{openDocument:S}=Z(),q=p(()=>Number(b.params.id)),t=T(null),c=T(null),$=T(!1),M=p(()=>{if(!t.value)return null;const n=d.issues.value.findIndex(l=>l.id===t.value.id);return n<d.issues.value.length-1?d.issues.value[n+1]:null}),g=p(()=>{if(!t.value)return null;const n=d.issues.value.findIndex(l=>l.id===t.value.id);return n>0?d.issues.value[n-1]:null}),w=p(()=>t.value?d.issues.value.filter(n=>n.id!==t.value.id).slice(0,3):[]),C=p(()=>D.isDarkMode?"bg-dark text-white q-dark":"bg-white text-dark"),B=p(()=>D.isDarkMode?"text-grey-4":"text-grey-7");de(async()=>{d.issues.value.length===0&&await d.loadIssues(),i()}),ce(()=>b.params.id,n=>{n&&i()});function i(){const n=d.issues.value.find(l=>l.id===q.value);n?(t.value=n,y()):u.push("/archive")}function y(){if(t.value)try{$.value=!0,c.value={filename:t.value.filename,fileSize:t.value.fileSize,lastModified:t.value.date,pages:t.value.pages}}catch(n){console.error("Failed to load metadata:",n)}finally{$.value=!1}}function se(){if(!t.value)return;const n={id:t.value.id,title:t.value.title,date:t.value.date,pages:t.value.pages,url:t.value.googleDriveUrl||t.value.localUrl||t.value.url||"",filename:t.value.filename};S(n)}function U(n){u.push(`/archive/${n.id}`)}const j=n=>{try{return new Date(n).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}catch{return n}};return(n,l)=>(o(),_(_e,{padding:""},{default:s(()=>[a("div",Le,[a("div",Fe,[a("div",Ne,[e(ye,{class:"q-mb-md"},{default:s(()=>[e(E,{icon:"mdi-home",to:"/"}),e(E,{label:"Archive",to:"/archive"}),e(E,{label:t.value?.title||"Issue Details"},null,8,["label"])]),_:1}),!A(d).loading.value&&!t.value?(o(),_(P,{key:0,flat:"",class:k([C.value,"text-center q-pa-xl"])},{default:s(()=>[e(h,{name:"mdi-alert-circle",size:"4em",color:"warning"}),l[3]||(l[3]=a("div",{class:"text-h6 q-mt-md"},"Issue not found",-1)),a("div",{class:k([B.value,"q-mt-sm"])}," The requested issue could not be found. ",2),e(z,{color:"primary",to:"/archive",class:"q-mt-md"},{default:s(()=>l[2]||(l[2]=[f(" Back to Archive ",-1)])),_:1,__:[2]})]),_:1,__:[3]},8,["class"])):A(d).loading.value?(o(),_(P,{key:1,flat:"",class:k([C.value,"text-center q-pa-xl"])},{default:s(()=>[e(V,{size:"4em",color:"primary"}),l[4]||(l[4]=a("div",{class:"text-h6 q-mt-md"},"Loading issue...",-1))]),_:1,__:[4]},8,["class"])):t.value?(o(),x("div",Re,[a("div",Te,[e(P,{flat:"",class:k([C.value,"q-mb-lg"])},{default:s(()=>[e(N,null,{default:s(()=>[a("div",Ae,[a("div",Ee,[a("div",Ve,[a("div",Ge,[e(h,{name:"mdi-file-pdf-box",size:"64px",color:"grey-6"}),a("div",{class:k(["text-caption mt-2 text-center px-2",B.value])},m(t.value.filename),3)])]),a("div",Ue,[e(z,{color:"primary",icon:"mdi-open-in-new",label:"Open PDF",class:"full-width",onClick:se})])]),a("div",je,[a("div",Oe,m(t.value.title),1),a("div",Je,[a("div",Ke,[e(J,{icon:"mdi-calendar",color:"primary","text-color":"white"},{default:s(()=>[f(m(j(t.value.date)),1)]),_:1})]),a("div",He,[e(J,{icon:"mdi-file-document",color:"secondary","text-color":"white"},{default:s(()=>[f(m(t.value.pages)+" pages ",1)]),_:1})])]),a("div",We,[l[6]||(l[6]=a("div",{class:"text-subtitle1 q-mb-sm"},"Status & Sync",-1)),a("div",Xe,[a("div",Ye,[e(G,{color:t.value.syncStatus==="synced"?"positive":"warning",icon:t.value.syncStatus==="synced"?"mdi-cloud-check":"mdi-cloud-sync"},{default:s(()=>[f(m(t.value.syncStatus),1)]),_:1},8,["color","icon"])]),a("div",Ze,[e(G,{color:"info",icon:"mdi-google-drive"},{default:s(()=>l[5]||(l[5]=[f(" Google Drive ",-1)])),_:1,__:[5]})])])]),c.value?(o(),x("div",es,[l[11]||(l[11]=a("div",{class:"text-subtitle1 q-mb-sm"},"File Information",-1)),e(ge,{separator:"",class:"rounded-borders"},{default:s(()=>[e(R,null,{default:s(()=>[e(I,{avatar:""},{default:s(()=>[e(h,{name:"mdi-file"})]),_:1}),e(I,null,{default:s(()=>[e(Q,null,{default:s(()=>l[7]||(l[7]=[f("Filename",-1)])),_:1,__:[7]}),e(Q,{caption:""},{default:s(()=>[f(m(t.value.filename),1)]),_:1})]),_:1})]),_:1}),c.value&&c.value.fileSize?(o(),_(R,{key:0},{default:s(()=>[e(I,{avatar:""},{default:s(()=>[e(h,{name:"mdi-harddisk"})]),_:1}),e(I,null,{default:s(()=>[e(Q,null,{default:s(()=>l[8]||(l[8]=[f("File Size",-1)])),_:1,__:[8]}),e(Q,{caption:""},{default:s(()=>[f(m(c.value.fileSize),1)]),_:1})]),_:1})]),_:1})):v("",!0),t.value.lastModified?(o(),_(R,{key:1},{default:s(()=>[e(I,{avatar:""},{default:s(()=>[e(h,{name:"mdi-clock"})]),_:1}),e(I,null,{default:s(()=>[e(Q,null,{default:s(()=>l[9]||(l[9]=[f("Last Modified",-1)])),_:1,__:[9]}),e(Q,{caption:""},{default:s(()=>[f(m(j(t.value.lastModified)),1)]),_:1})]),_:1})]),_:1})):v("",!0),t.value.googleDriveFileId?(o(),_(R,{key:2},{default:s(()=>[e(I,{avatar:""},{default:s(()=>[e(h,{name:"mdi-google-drive"})]),_:1}),e(I,null,{default:s(()=>[e(Q,null,{default:s(()=>l[10]||(l[10]=[f("Google Drive ID",-1)])),_:1,__:[10]}),e(Q,{caption:""},{default:s(()=>[f(m(t.value.googleDriveFileId),1)]),_:1})]),_:1})]),_:1})):v("",!0)]),_:1})])):v("",!0),$.value?(o(),x("div",ss,[e(V),l[12]||(l[12]=a("div",{class:"text-caption q-mt-sm"},"Loading file information...",-1))])):v("",!0)])])]),_:1})]),_:1},8,["class"])]),a("div",ts,[e(P,{flat:"",class:k([C.value,"q-mb-lg"])},{default:s(()=>[e(N,null,{default:s(()=>[l[13]||(l[13]=a("div",{class:"text-h6 q-mb-md"},"Navigation",-1)),g.value?(o(),_(z,{key:0,outline:"",color:"primary",icon:"mdi-chevron-left",label:g.value.title,class:"full-width q-mb-sm text-left",onClick:l[0]||(l[0]=F=>U(g.value))},null,8,["label"])):v("",!0),M.value?(o(),_(z,{key:1,outline:"",color:"primary","icon-right":"mdi-chevron-right",label:M.value.title,class:"full-width q-mb-sm text-left",onClick:l[1]||(l[1]=F=>U(M.value))},null,8,["label"])):v("",!0),e(z,{color:"secondary",icon:"mdi-archive",label:"Back to Archive",class:"full-width",to:"/archive"})]),_:1,__:[13]})]),_:1},8,["class"]),w.value.length>0?(o(),_(P,{key:0,flat:"",class:k(C.value)},{default:s(()=>[e(N,null,{default:s(()=>[l[14]||(l[14]=a("div",{class:"text-h6 q-mb-md"},"Related Issues",-1)),a("div",as,[(o(!0),x(me,null,fe(w.value,F=>(o(),_(Pe,{key:F.id,issue:F,thumbnail:F.thumbnailUrl,"is-loading":A(d).loading.value,"show-metadata":!1,onRegenerateThumbnail:()=>{}},null,8,["issue","thumbnail","is-loading"]))),128))])]),_:1,__:[14]})]),_:1},8,["class"])):v("",!0)])])):v("",!0)])])])]),_:1}))}}),ks=ee(ls,[["__scopeId","data-v-6613e41a"]]);export{ks as default};
