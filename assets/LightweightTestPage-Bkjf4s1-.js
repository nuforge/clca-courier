import{d as R,r as m,o as $,w as B,a4 as u,a5 as s,f as l,M as o,a6 as T,a7 as w,P as f,Q as A,bl as M,N as U,R as K,aa as k,a2 as i,a3 as c,I as h,F as S,a9 as b,J as a}from"./index-DDm66URI.js";import{u as E,Q as J}from"./useAdvancedSearch-g9y02jOW.js";import{Q as r}from"./QChip-D9zTuX27.js";import{l as P}from"./lightweight-newsletter-service-N3_P_kRl.js";import"./QBtnGroup-Y3E2aR4E.js";import"./pdf-metadata-service-CsES0isO.js";const j={class:"lightweight-test-page q-pa-md"},G={class:"row q-gutter-md"},H={class:"col-12"},O={class:"row q-gutter-md items-center q-mb-md"},W={class:"col-12 col-md-6"},X={class:"col-12 col-md-3"},Y={class:"col-12 col-md-3"},Z={class:"row q-gutter-md q-mb-md"},ee={class:"col"},te={class:"col"},se={class:"col"},oe={class:"col"},ae={key:0,class:"q-mb-md"},le={class:"text-subtitle1 q-mb-sm"},ie={class:"row q-gutter-sm"},ce={class:"text-subtitle2"},ne={class:"text-caption text-grey-6"},re={key:0,class:"q-mt-xs"},de={class:"row q-gutter-sm"},ue={class:"text-subtitle2"},ge={class:"text-caption text-grey-6"},he={class:"q-mt-xs"},ve={key:0,class:"q-mt-xs"},Se=R({__name:"LightweightTestPage",setup(me){const{isSearching:z,searchResults:N,searchStats:q,performSearch:Q,clearSearch:V,updateFilters:L}=E(),p=m([]),n=m(""),y=m("lightweight"),d=m([]),D=m(!0),v=m({total:0,processed:0,processing:0,pending:0});$(async()=>{console.log("[LightweightTest] Starting newsletter load...");const g=Date.now();try{p.value=await P.getNewsletters(),v.value=P.getProcessingStats();const t=Date.now()-g;console.log(`[LightweightTest] âœ… Loaded ${p.value.length} newsletters in ${t}ms`);const e=setInterval(()=>{v.value=P.getProcessingStats(),v.value.processing===0&&v.value.pending===0&&clearInterval(e)},2e3)}catch(t){console.error("[LightweightTest] Failed to load newsletters:",t)}finally{D.value=!1}});const x=async()=>{if(!n.value||n.value.length<2){d.value=[];return}console.log(`[LightweightTest] Searching: "${n.value}" (mode: ${y.value})`);const g=Date.now();try{if(y.value==="lightweight"){const t=await P.searchNewsletters(n.value);d.value=t.map(e=>({id:e.id,title:e.title,date:e.date,filename:e.filename,pages:e.pages,score:1,isProcessed:e.isProcessed,isProcessing:e.isProcessing,topics:e.topics??void 0})),console.log(`[LightweightTest] Lightweight search completed: ${d.value.length} results`)}else{L({includeContent:!0});const t=p.value.map(e=>({id:e.id,title:e.title,date:e.date,pages:e.pages,filename:e.filename,status:"local",syncStatus:"synced",url:e.url??"",description:e.title??"",fileSize:e.fileSize??"",thumbnailUrl:e.thumbnailUrl??"",tags:e.topics??[],category:e.contentType??""}));await Q(t,n.value),d.value=N.value.map(e=>({id:e.id,title:e.title,date:e.date,filename:e.filename,pages:e.pages,score:e.score,snippet:e.snippet||void 0,topics:e.tags?[...e.tags]:void 0}))}console.log(`[LightweightTest] Found ${d.value.length} results in ${Date.now()-g}ms`)}catch(t){console.error("[LightweightTest] Search failed:",t),d.value=[]}},F=()=>{n.value="",d.value=[],V()},I=g=>{L({includeContent:g==="content"}),n.value&&n.value.length>=2&&x()};let C;return B(n,g=>{clearTimeout(C),C=setTimeout(()=>{g&&g.length>=2?x():d.value=[]},300)}),(g,t)=>(a(),u("div",j,[s("div",G,[s("div",H,[l(T,null,{default:o(()=>[l(w,null,{default:o(()=>t[2]||(t[2]=[s("div",{class:"text-h6"},"ðŸš€ Lightweight PDF Processing Test",-1),s("div",{class:"text-subtitle2 text-grey-7"},"Testing fast loading with smart caching",-1)])),_:1,__:[2]}),l(w,null,{default:o(()=>[s("div",O,[s("div",W,[l(A,{modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=e=>n.value=e),placeholder:"Search newsletters (instant results)...",outlined:"",clearable:"",onClear:F,onKeyup:M(x,["enter"])},{prepend:o(()=>[l(U,{name:"search"})]),_:1},8,["modelValue"])]),s("div",X,[l(J,{modelValue:y.value,"onUpdate:modelValue":[t[1]||(t[1]=e=>y.value=e),I],"no-caps":"",unelevated:"","toggle-color":"primary",options:[{label:"Fast",value:"lightweight"},{label:"Content",value:"content"}]},null,8,["modelValue"])]),s("div",Y,[l(K,{color:"primary",label:"Search",onClick:x,loading:k(z),disable:!n.value||n.value.length<2},null,8,["loading","disable"])])]),s("div",Z,[s("div",ee,[l(r,{color:"primary","text-color":"white",icon:"description"},{default:o(()=>[i(c(p.value.length)+" Newsletters ",1)]),_:1})]),s("div",te,[l(r,{color:"positive","text-color":"white",icon:"cached"},{default:o(()=>[i(c(v.value.processed)+" Processed ",1)]),_:1})]),s("div",se,[l(r,{color:"orange","text-color":"white",icon:"hourglass_empty"},{default:o(()=>[i(c(v.value.processing)+" Processing ",1)]),_:1})]),s("div",oe,[l(r,{color:"grey","text-color":"white",icon:"pending"},{default:o(()=>[i(c(v.value.pending)+" Pending ",1)]),_:1})])]),d.value.length>0?(a(),u("div",ae,[s("div",le,[i(" Search Results ("+c(d.value.length)+") ",1),k(q).searchTime>0?(a(),h(r,{key:0,size:"sm",color:"grey-3"},{default:o(()=>[i(c(k(q).searchTime)+"ms ",1)]),_:1})):f("",!0)]),s("div",ie,[(a(!0),u(S,null,b(d.value.slice(0,6),e=>(a(),u("div",{key:e.id,class:"col-12 col-md-6"},[l(T,{flat:"",bordered:""},{default:o(()=>[l(w,{class:"q-pa-sm"},{default:o(()=>[s("div",ce,c(e.title),1),s("div",ne,[i(c(e.filename)+" â€¢ "+c(e.pages)+" pages ",1),e.isProcessed?(a(),h(r,{key:0,size:"xs",color:"positive","text-color":"white"},{default:o(()=>t[3]||(t[3]=[i(" Rich Data ",-1)])),_:1,__:[3]})):e.isProcessing?(a(),h(r,{key:1,size:"xs",color:"orange","text-color":"white"},{default:o(()=>t[4]||(t[4]=[i(" Processing ",-1)])),_:1,__:[4]})):f("",!0)]),e.topics&&e.topics.length>0?(a(),u("div",re,[(a(!0),u(S,null,b(e.topics.slice(0,3),_=>(a(),h(r,{key:_,size:"xs",color:"grey-3"},{default:o(()=>[i(c(_),1)]),_:2},1024))),128))])):f("",!0)]),_:2},1024)]),_:2},1024)]))),128))])])):f("",!0),t[8]||(t[8]=s("div",{class:"text-subtitle1 q-mb-sm"},"All Newsletters",-1)),s("div",de,[(a(!0),u(S,null,b(p.value.slice(0,12),e=>(a(),u("div",{key:e.id,class:"col-12 col-sm-6 col-md-4 col-lg-3"},[l(T,{flat:"",bordered:""},{default:o(()=>[l(w,{class:"q-pa-sm"},{default:o(()=>[s("div",ue,c(e.title),1),s("div",ge,c(e.date)+" â€¢ "+c(e.pages)+" pages ",1),s("div",he,[e.isProcessed?(a(),h(r,{key:0,size:"xs",color:"positive","text-color":"white",icon:"check"},{default:o(()=>t[5]||(t[5]=[i(" Processed ",-1)])),_:1,__:[5]})):e.isProcessing?(a(),h(r,{key:1,size:"xs",color:"orange","text-color":"white",icon:"hourglass_empty"},{default:o(()=>t[6]||(t[6]=[i(" Processing ",-1)])),_:1,__:[6]})):(a(),h(r,{key:2,size:"xs",color:"grey","text-color":"white",icon:"pending"},{default:o(()=>t[7]||(t[7]=[i(" Pending ",-1)])),_:1,__:[7]}))]),e.topics&&e.topics.length>0?(a(),u("div",ve,[(a(!0),u(S,null,b(e.topics.slice(0,2),_=>(a(),h(r,{key:_,size:"xs",color:"grey-3"},{default:o(()=>[i(c(_),1)]),_:2},1024))),128))])):f("",!0)]),_:2},1024)]),_:2},1024)]))),128))])]),_:1,__:[8]})]),_:1})])])]))}});export{Se as default};
