import{d as Z,r as b,c as u,o as ee,I as v,M as a,a5 as l,f as s,a7 as z,a4 as d,P as m,a2 as n,N as w,a3 as g,R as A,K as p,a6 as T,$ as E,ab as te,Q as le,aa as H,ad as j,ak as se,F,a9 as G,J as r}from"./index-CvPvUhNI.js";import{Q as oe}from"./QSpinnerDots-DinRExD4.js";import{Q as K}from"./QBanner-B6GfX89z.js";import{Q as _}from"./QChip-DCSXUmoP.js";import{Q}from"./QTooltip-Deyd2iAk.js";import{Q as ae}from"./QSelect-Bu0TZdPP.js";import{u as re,Q as ne,H as Y}from"./HybridNewsletterCard-CEmE7Bti.js";import{Q as ie}from"./QSlideTransition-hOnyKnX3.js";import{Q as de}from"./QPage-BJJNKmx3.js";import{u as ue}from"./site-store-simple-CUAg8p33.js";import{_ as ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./position-engine-BInOcCRv.js";import"./selection-UCfsP1ox.js";import"./QItem-CgZWTmks.js";import"./QMenu-BHQoJi1p.js";import"./format-BvkBI9bc.js";import"./QBtnDropdown-BiN4mYnP.js";import"./QImg-Bw2H4alN.js";import"./QSpace-fv37HLto.js";import"./QList-CHUIHOpF.js";import"./ClosePopup-D0b8teNA.js";import"./use-quasar-vJYE3-ml.js";import"./pdf-metadata-service-CImhVS20.js";import"./pdf-ZhLmi4kS.js";import"./path-utils-Bbt-OTF7.js";import"./usePdfViewer-9-AnGuAU.js";import"./useUserSettings-ByKUlGL4.js";const me={class:"q-pa-md"},ve={class:"row justify-center"},ge={class:"col-12 col-md-10 col-lg-8"},pe={class:"text-h4 q-mb-md"},fe={key:0,class:"row q-gutter-md q-mt-md"},ye={class:"col"},be={class:"text-h6 q-mb-md"},we={key:1,class:"q-mt-sm text-body2 text-grey-7"},_e={class:"row q-col-gutter-md q-mb-md"},he={class:"col-12 col-md-6"},ke={class:"col-6 col-md-3"},xe={class:"col-6 col-md-3"},qe={class:"q-mb-md"},Ce={class:"q-mb-md"},Qe={class:"text-h6 q-mb-md"},Be={key:0},De={class:"text-h6 q-mb-md"},Se={class:"row q-col-gutter-md"},Ie={key:1},Ve={class:"row q-col-gutter-md"},Ne={key:2,class:"text-center q-mt-lg"},Le={class:"q-mt-sm"},ze={key:0,class:"q-mt-md"},Ae=Z({__name:"IssueArchivePage",setup(Te){const h=ue(),k=re(),B=b(!1),D=b("date"),S=b("desc"),x=b(""),q=b(!1),I=u(()=>h.isDarkMode?"bg-dark text-white q-dark":"bg-white text-dark"),J=u(()=>h.isDarkMode?"text-grey-4":"text-grey-7"),C=u(()=>k.newsletters.value),V=u(()=>k.loading.value),f=u(()=>k.error.value),M=u(()=>{let o=C.value;if(x.value.trim()){const e=x.value.toLowerCase();o=o.filter(t=>t.title.toLowerCase().includes(e)||t.filename.toLowerCase().includes(e)||t.topics&&t.topics.some(i=>i.toLowerCase().includes(e))||t.tags&&t.tags.some(i=>i.toLowerCase().includes(e)))}return o=[...o].sort((e,t)=>{let i=0;switch(D.value){case"date":i=new Date(e.date).getTime()-new Date(t.date).getTime();break;case"title":i=e.title.localeCompare(t.title);break;case"pages":i=e.pages-t.pages;break;case"size":{const c=O(e.fileSize||"0"),X=O(t.fileSize||"0");i=c-X;break}}return S.value==="desc"?-i:i}),o}),y=u(()=>M.value),N=u(()=>{const o={};return M.value.forEach(e=>{const t=new Date(e.date).getFullYear().toString();o[t]||(o[t]=[]),o[t].push(e)}),o}),W=[{label:"Date",value:"date"},{label:"Title",value:"title"},{label:"Pages",value:"pages"},{label:"File Size",value:"size"}],O=o=>{if(!o||o==="Unknown")return 0;const e=o.match(/^([\d.]+)\s*(B|KB|MB|GB)$/i);if(!e||!e[1]||!e[2])return 0;const t=e[1],i=e[2],c=parseFloat(t);switch(i.toUpperCase()){case"B":return c;case"KB":return c*1024;case"MB":return c*1024*1024;case"GB":return c*1024*1024*1024;default:return 0}},P=()=>"col-12 col-xs-6 col-sm-4 col-md-4 col-lg-3 col-xl-3",U=u(()=>C.value.filter(o=>o.driveId&&o.localFile).length),R=u(()=>C.value.filter(o=>o.localFile&&!o.driveId).length),$=u(()=>C.value.filter(o=>o.driveId&&!o.localFile).length);ee(async()=>{await L()});async function L(){console.log("ðŸ”„ Loading newsletters from local files and Google Drive..."),await k.loadNewsletters(),console.log("âœ… Newsletter loading complete")}return(o,e)=>(r(),v(de,{padding:""},{default:a(()=>[l("div",me,[l("div",ve,[l("div",ge,[s(T,{flat:"",class:p([I.value,"q-mb-md"])},{default:a(()=>[s(z,null,{default:a(()=>[l("div",pe,[s(w,{name:"mdi-bookshelf",class:"q-mr-sm"}),e[7]||(e[7]=n(" Issue Archive ",-1))]),e[13]||(e[13]=l("p",{class:"text-body1"},[n(" Browse through past issues of The Courier with our "),l("strong",null,"REAL Google Drive integration"),n(". Issues are loaded from your actual Google Drive folders and local web hosting, ensuring fast access and reliable downloads. "),l("strong",null,"No more test data!")],-1)),f.value||V.value?(r(),d("div",fe,[l("div",ye,[V.value?(r(),v(K,{key:0,class:"bg-primary text-white",rounded:""},{avatar:a(()=>[s(oe)]),default:a(()=>[e[8]||(e[8]=l("div",null,[l("strong",null,"Loading Newsletter Archive..."),l("br"),n(" Loading newsletters from local files and Google Drive folders... ")],-1))]),_:1,__:[8]})):f.value?(r(),v(K,{key:1,class:"bg-negative text-white",rounded:""},{avatar:a(()=>[s(w,{name:"mdi-alert"})]),default:a(()=>[l("div",null,[e[9]||(e[9]=l("strong",null,"Error Loading Newsletters",-1)),e[10]||(e[10]=l("br",null,null,-1)),n(" "+g(f.value)+" ",1),e[11]||(e[11]=l("br",null,null,-1)),e[12]||(e[12]=l("br",null,null,-1)),s(A,{flat:"",color:"white",label:"Retry",onClick:e[0]||(e[0]=t=>L())})])]),_:1})):m("",!0)])])):m("",!0)]),_:1,__:[13]})]),_:1},8,["class"]),s(T,{flat:"",class:p(I.value)},{default:a(()=>[s(z,null,{default:a(()=>[l("div",be,[e[17]||(e[17]=n(" Available Issues ",-1)),y.value.length>0?(r(),v(_,{key:0,color:"primary","text-color":"white",class:"q-ml-sm"},{default:a(()=>[n(g(y.value.length)+" issues ",1)]),_:1})):m("",!0),y.value.length>0?(r(),d("div",we,[U.value>0?(r(),v(_,{key:0,icon:"sync",color:"secondary","text-color":"white",size:"sm",dense:""},{default:a(()=>[n(g(U.value)+" Hybrid ",1),s(Q,null,{default:a(()=>e[14]||(e[14]=[n("Issues available from both local and Google Drive sources",-1)])),_:1,__:[14]})]),_:1})):m("",!0),R.value>0?(r(),v(_,{key:1,icon:"computer",color:"positive","text-color":"white",size:"sm",dense:"",class:"q-ml-xs"},{default:a(()=>[n(g(R.value)+" Local Only ",1),s(Q,null,{default:a(()=>e[15]||(e[15]=[n("Issues available locally for fast web viewing",-1)])),_:1,__:[15]})]),_:1})):m("",!0),$.value>0?(r(),v(_,{key:2,icon:"cloud",color:"info","text-color":"white",size:"sm",dense:"",class:"q-ml-xs"},{default:a(()=>[n(g($.value)+" Drive Only ",1),s(Q,null,{default:a(()=>e[16]||(e[16]=[n("Issues available from Google Drive archive",-1)])),_:1,__:[16]})]),_:1})):m("",!0)])):m("",!0)]),s(te,{class:"q-mb-md"}),l("div",_e,[l("div",he,[s(le,{modelValue:x.value,"onUpdate:modelValue":e[2]||(e[2]=t=>x.value=t),outlined:"",placeholder:"Search issues, topics, and tags...",clearable:"","bg-color":H(h).isDarkMode?"grey-9":"white"},{prepend:a(()=>[s(w,{name:"mdi-magnify"})]),append:a(()=>[s(A,{round:"",dense:"",flat:"",icon:"mdi-tune",onClick:e[1]||(e[1]=t=>q.value=!q.value),color:q.value?"primary":"grey-6"},{default:a(()=>[s(Q,null,{default:a(()=>e[18]||(e[18]=[n("Advanced Search",-1)])),_:1,__:[18]})]),_:1},8,["color"])]),_:1},8,["modelValue","bg-color"])]),l("div",ke,[s(ae,{modelValue:D.value,"onUpdate:modelValue":e[3]||(e[3]=t=>D.value=t),options:W,outlined:"",label:"Sort by","emit-value":"","map-options":"","bg-color":H(h).isDarkMode?"grey-9":"white"},null,8,["modelValue","bg-color"])]),l("div",xe,[s(ne,{modelValue:S.value,"onUpdate:modelValue":e[4]||(e[4]=t=>S.value=t),"toggle-color":"primary",options:[{label:"Asc",value:"asc",icon:"mdi-sort-ascending"},{label:"Desc",value:"desc",icon:"mdi-sort-descending"}],outline:""},null,8,["modelValue"])])]),E(l("div",qe,[s(se,{modelValue:B.value,"onUpdate:modelValue":e[5]||(e[5]=t=>B.value=t),label:"Group by year",color:"primary"},null,8,["modelValue"])],512),[[j,Object.keys(N.value).length>1]]),s(ie,null,{default:a(()=>[E(l("div",Ce,[s(T,{flat:"",class:p(I.value)},{default:a(()=>[s(z,null,{default:a(()=>[l("div",Qe,[s(w,{name:"mdi-tune",class:"q-mr-sm"}),e[20]||(e[20]=n(" Advanced Search ",-1)),s(_,{color:"orange","text-color":"white",class:"q-ml-sm"},{default:a(()=>e[19]||(e[19]=[n("Coming Soon",-1)])),_:1,__:[19]})]),e[21]||(e[21]=l("p",{class:"text-body2"}," Advanced search with PDF content scanning, date ranges, and relevance scoring will be available soon. Currently, use the search box above to find issues by title, topics, and tags. ",-1))]),_:1,__:[21]})]),_:1},8,["class"])],512),[[j,q.value]])]),_:1}),l("div",null,[B.value&&Object.keys(N.value).length>1?(r(),d("div",Be,[(r(!0),d(F,null,G(N.value,(t,i)=>(r(),d("div",{key:i,class:"q-mb-lg"},[l("div",De,g(i),1),l("div",Se,[(r(!0),d(F,null,G(t,c=>(r(),d("div",{class:p(P()),key:c.id},[s(Y,{newsletter:c},null,8,["newsletter"])],2))),128))])]))),128))])):(r(),d("div",Ie,[l("div",Ve,[(r(!0),d(F,null,G(y.value,t=>(r(),d("div",{class:p(P()),key:t.id},[s(Y,{newsletter:t},null,8,["newsletter"])],2))),128))])])),y.value.length===0&&!V.value?(r(),d("div",Ne,[s(w,{name:"mdi-bookshelf",size:"4em",color:"grey-5"}),l("div",{class:p([J.value,"q-mt-md"])},[e[22]||(e[22]=l("div",{class:"text-h6"},"No Newsletter Issues Found",-1)),l("div",Le,g(f.value?"There was an error loading the newsletter archive.":"The newsletter archive appears to be empty."),1),f.value?(r(),d("div",ze,[s(A,{color:"primary",label:"Refresh",onClick:e[6]||(e[6]=t=>L())})])):m("",!0)],2)])):m("",!0)])]),_:1})]),_:1},8,["class"])])])])]),_:1}))}}),ut=ce(Ae,[["__scopeId","data-v-88e88c98"]]);export{ut as default};
