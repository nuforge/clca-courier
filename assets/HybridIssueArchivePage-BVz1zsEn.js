import{k as j,al as F,am as O,h as $,d as E,r as b,c as M,o as R,I as y,M as i,a5 as a,f as l,a4 as o,P as f,a7 as _,a2 as L,N as h,aa as c,a3 as d,K as B,a6 as w,R as x,Q as Y,F as k,a9 as C,J as s,aj as J}from"./index-WAZpiL6p.js";import{u as K,Q as A,H}from"./HybridNewsletterCard-DsF7Qmem.js";import{Q as W}from"./QSpace-DinSJI12.js";import{Q as X}from"./QSelect-B_QXVp8r.js";import{Q as Z}from"./QBanner-CchCn5Mh.js";import{u as ee,Q as te}from"./useDynamicGoogleDriveIssues-CJ9zXfpy.js";import{Q as ae}from"./QPage-CRV1LXMZ.js";import{u as le}from"./site-store-simple-BnFZhcbF.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./QBtnDropdown-7SkJEtLX.js";import"./QMenu-zUgzQUqw.js";import"./position-engine-BGdTm09t.js";import"./selection-DmVi8G6u.js";import"./QTooltip-DLJz-SB9.js";import"./QImg-d1Jv0_5X.js";import"./QSpinnerDots-DbD4BrjI.js";import"./QChip-DvKKwpRo.js";import"./QItem-EHy2jVcG.js";import"./QList-B1UmnzKi.js";import"./ClosePopup-uDYSfG36.js";import"./use-quasar-DCLah36D.js";import"./pdf-metadata-service-CImhVS20.js";import"./pdf-ZhLmi4kS.js";import"./usePdfViewer-_W0lU-g9.js";import"./format-BvkBI9bc.js";import"./useUserSettings-DbiFVqxl.js";const oe='<circle cx="12.5" cy="12.5" r="12.5"><animate attributeName="fill-opacity" begin="0s" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="12.5" cy="52.5" r="12.5" fill-opacity=".5"><animate attributeName="fill-opacity" begin="100ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="52.5" cy="12.5" r="12.5"><animate attributeName="fill-opacity" begin="300ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="52.5" cy="52.5" r="12.5"><animate attributeName="fill-opacity" begin="600ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="92.5" cy="12.5" r="12.5"><animate attributeName="fill-opacity" begin="800ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="92.5" cy="52.5" r="12.5"><animate attributeName="fill-opacity" begin="400ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="12.5" cy="92.5" r="12.5"><animate attributeName="fill-opacity" begin="700ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="52.5" cy="92.5" r="12.5"><animate attributeName="fill-opacity" begin="500ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="92.5" cy="92.5" r="12.5"><animate attributeName="fill-opacity" begin="200ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle>',ie=j({name:"QSpinnerGrid",props:F,setup(G){const{cSize:q,classes:r}=O(G);return()=>$("svg",{class:r.value,fill:"currentColor",width:q.value,height:q.value,viewBox:"0 0 105 105",xmlns:"http://www.w3.org/2000/svg",innerHTML:oe})}}),re={class:"q-pa-md"},ne={class:"row justify-center"},ce={class:"col-12 col-md-10 col-lg-8"},de={class:"text-h4 q-mb-md"},ue={key:0,class:"q-mt-md"},me={class:"row q-gutter-md text-center"},ve={class:"col"},pe={class:"text-h6 text-primary"},ye={class:"col"},fe={class:"text-h6 text-positive"},ge={class:"col"},be={class:"text-h6 text-info"},_e={class:"row items-center q-mb-md"},he={key:0},we={key:1,class:"row q-gutter-md items-end"},xe={class:"col"},ke={class:"col-auto"},Ce={class:"col-auto"},qe={class:"col-auto"},Ne={key:0,class:"text-center q-pa-xl"},Se={key:2},Qe={key:0},Ve={class:"text-h5 q-mb-md text-primary"},De={class:"row q-gutter-md"},Te={key:1,class:"row q-gutter-md"},Me={key:2,class:"q-gutter-md"},Be={class:"text-h5 q-mb-md"},Ie={class:"row q-gutter-md"},Le={class:"text-subtitle1"},Ae={class:"text-caption text-grey-6"},He={class:"text-caption"},Ge={key:0,class:"text-caption"},ze={class:"text-h6 q-mt-md text-grey-6"},Pe={class:"text-body2 text-grey-6 q-mt-sm"},Ue=E({__name:"HybridIssueArchivePage",setup(G){const q=le(),r=K(),N=ee(),S=b("grid"),Q=b("date"),V=b("desc"),u=b(""),D=b(!1),T=M(()=>q.isDarkMode?"bg-dark text-white q-dark":"bg-white text-dark"),z=M(()=>{let m=r.newsletters.value;if(u.value.trim()){const e=u.value.toLowerCase();m=m.filter(t=>t.title.toLowerCase().includes(e)||t.filename.toLowerCase().includes(e)||t.topics&&t.topics.some(n=>n.toLowerCase().includes(e))||t.tags&&t.tags.some(n=>n.toLowerCase().includes(e)))}return m=[...m].sort((e,t)=>{let n=0;switch(Q.value){case"date":n=new Date(e.publishDate||e.date).getTime()-new Date(t.publishDate||t.date).getTime();break;case"title":n=e.title.localeCompare(t.title);break;case"pages":n=e.pages-t.pages;break;case"contentType":n=(e.contentType||"newsletter").localeCompare(t.contentType||"newsletter");break}return V.value==="desc"?-n:n}),m}),I=M(()=>D.value?[]:z.value),P=M(()=>{const m=r.newslettersByYear.value,e={};for(const[t,n]of Object.entries(m))e[t]=[...n].sort((v,g)=>{let p=0;switch(Q.value){case"date":p=new Date(v.publishDate||v.date).getTime()-new Date(g.publishDate||g.date).getTime();break;case"title":p=v.title.localeCompare(g.title);break;case"pages":p=v.pages-g.pages;break;case"contentType":p=(v.contentType||"newsletter").localeCompare(g.contentType||"newsletter");break}return V.value==="desc"?-p:p});return e}),U=[{label:"Date",value:"date"},{label:"Title",value:"title"},{label:"Pages",value:"pages"},{label:"Type",value:"contentType"}];return R(async()=>{await r.loadNewsletters(),await N.loadIssues()}),(m,e)=>(s(),y(ae,{padding:""},{default:i(()=>[a("div",re,[a("div",ne,[a("div",ce,[l(w,{flat:"",class:B([T.value,"q-mb-md"])},{default:i(()=>[l(_,null,{default:i(()=>[a("div",de,[l(h,{name:"mdi-bookshelf",class:"q-mr-sm"}),e[7]||(e[7]=L(" Newsletter Archive ",-1))]),e[11]||(e[11]=a("p",{class:"text-body1"}," Browse through past issues of The Courier with our hybrid hosting approach. Enjoy fast local access for viewing and high-quality downloads from our archive. ",-1)),c(r).serviceStats.value?(s(),o("div",ue,[a("div",me,[a("div",ve,[a("div",pe,d(c(r).serviceStats.value.totalNewsletters),1),e[8]||(e[8]=a("div",{class:"text-caption"},"Total Issues",-1))]),a("div",ye,[a("div",fe,d(c(r).serviceStats.value.sourceCounts.hybrid),1),e[9]||(e[9]=a("div",{class:"text-caption"},"Hybrid Sources",-1))]),a("div",ge,[a("div",be,d(c(r).serviceStats.value.sourceCounts.local),1),e[10]||(e[10]=a("div",{class:"text-caption"},"Local Only",-1))])])])):f("",!0)]),_:1,__:[11]})]),_:1},8,["class"]),l(w,{flat:"",class:B([T.value,"q-mb-md"])},{default:i(()=>[l(_,null,{default:i(()=>[a("div",_e,[l(A,{modelValue:D.value,"onUpdate:modelValue":e[0]||(e[0]=t=>D.value=t),options:[{label:"Simple Search",value:!1},{label:"Advanced Search",value:!0}],color:"primary","toggle-color":"secondary",class:"q-mr-md"},null,8,["modelValue"]),l(W),l(x,{flat:"",icon:"refresh",label:"Refresh",onClick:c(r).refresh,loading:c(r).loading.value},null,8,["onClick","loading"])]),D.value?(s(),o("div",he,e[12]||(e[12]=[a("div",{class:"text-body2 text-grey-6 q-mb-md"}," Advanced search is available but requires conversion of newsletter format. Using simple search for now. ",-1)]))):(s(),o("div",we,[a("div",xe,[l(Y,{modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=t=>u.value=t),placeholder:"Search newsletters...",outlined:"",clearable:"",onClear:e[2]||(e[2]=t=>u.value="")},{prepend:i(()=>[l(h,{name:"search"})]),_:1},8,["modelValue"])]),a("div",ke,[l(X,{modelValue:Q.value,"onUpdate:modelValue":e[3]||(e[3]=t=>Q.value=t),options:U,label:"Sort by",outlined:"","map-options":"","emit-value":"",style:{"min-width":"120px"}},null,8,["modelValue"])]),a("div",Ce,[l(A,{modelValue:V.value,"onUpdate:modelValue":e[4]||(e[4]=t=>V.value=t),options:[{icon:"keyboard_arrow_up",value:"asc",slot:"asc"},{icon:"keyboard_arrow_down",value:"desc",slot:"desc"}],color:"primary"},null,8,["modelValue"])]),a("div",qe,[l(A,{modelValue:S.value,"onUpdate:modelValue":e[5]||(e[5]=t=>S.value=t),options:[{icon:"view_list",value:"list"},{icon:"view_module",value:"grid"},{icon:"calendar_view_month",value:"year"}],color:"primary"},null,8,["modelValue"])])]))]),_:1})]),_:1},8,["class"]),c(r).loading.value?(s(),o("div",Ne,[l(ie,{color:"primary",size:"3em"}),e[13]||(e[13]=a("div",{class:"q-mt-md text-body1"},"Loading newsletters...",-1))])):c(r).error.value?(s(),y(Z,{key:1,class:"bg-negative text-white q-mb-md",rounded:""},{avatar:i(()=>[l(h,{name:"error"})]),action:i(()=>[l(x,{flat:"",label:"Retry",onClick:c(r).refresh},null,8,["onClick"])]),default:i(()=>[a("div",null,[e[14]||(e[14]=a("strong",null,"Error Loading Newsletters",-1)),e[15]||(e[15]=a("br",null,null,-1)),L(" "+d(c(r).error.value),1)])]),_:1})):f("",!0),I.value.length>0?(s(),o("div",Se,[S.value==="year"?(s(),o("div",Qe,[(s(!0),o(k,null,C(P.value,(t,n)=>(s(),o("div",{key:n,class:"q-mb-lg"},[a("div",Ve,d(n),1),a("div",De,[(s(!0),o(k,null,C(t,v=>(s(),o("div",{key:v.id,class:"col-12 col-md-6 col-lg-4"},[l(H,{newsletter:v},null,8,["newsletter"])]))),128))])]))),128))])):S.value==="grid"?(s(),o("div",Te,[(s(!0),o(k,null,C(I.value,t=>(s(),o("div",{key:t.id,class:"col-12 col-md-6 col-lg-4"},[l(H,{newsletter:t},null,8,["newsletter"])]))),128))])):(s(),o("div",Me,[(s(!0),o(k,null,C(I.value,t=>(s(),o("div",{key:t.id},[l(H,{newsletter:t},null,8,["newsletter"])]))),128))]))])):f("",!0),c(N).issues.value.length>0?(s(),y(w,{key:3,flat:"",class:B([T.value,"q-mt-lg"])},{default:i(()=>[l(_,null,{default:i(()=>[a("div",Be,[l(h,{name:"cloud",class:"q-mr-sm"}),e[16]||(e[16]=L(" Google Drive Archive ",-1)),l(te,{color:"info",label:`${c(N).issues.value.length} issues`,class:"q-ml-sm"},null,8,["label"])]),e[17]||(e[17]=a("p",{class:"text-body2 text-grey-6 q-mb-md"}," High-quality issues available for download from Google Drive ",-1)),a("div",Ie,[(s(!0),o(k,null,C(c(N).issues.value,t=>(s(),o("div",{key:t.id,class:"col-12 col-md-6 col-lg-4"},[l(w,{flat:"",bordered:"",class:"full-height"},{default:i(()=>[l(_,null,{default:i(()=>[a("div",Le,d(t.title),1),a("div",Ae,d(t.date),1),a("div",He,d(t.pages)+" pages",1),t.fileSize?(s(),o("div",Ge,d(t.fileSize),1)):f("",!0)]),_:2},1024),l(J,null,{default:i(()=>[l(x,{flat:"",icon:"cloud_download",label:"Download",color:"info",href:t.url||"#",target:"_blank",disable:!t.url},null,8,["href","disable"]),t.googleDriveFileId?(s(),y(x,{key:0,flat:"",icon:"open_in_new",label:"View in Drive",color:"secondary",href:`https://drive.google.com/file/d/${t.googleDriveFileId}/view`,target:"_blank"},null,8,["href"])):f("",!0)]),_:2},1024)]),_:2},1024)]))),128))])]),_:1,__:[17]})]),_:1},8,["class"])):(s(),y(w,{key:4,flat:"",class:B(T.value)},{default:i(()=>[l(_,{class:"text-center q-pa-xl"},{default:i(()=>[l(h,{name:"inbox",size:"4rem",color:"grey-5"}),a("div",ze,d(u.value?"No newsletters match your search":"No newsletters available"),1),a("div",Pe,d(u.value?"Try adjusting your search terms":"Check back later for new issues"),1),u.value?(s(),y(x,{key:0,flat:"",label:"Clear Search",color:"primary",onClick:e[6]||(e[6]=t=>u.value=""),class:"q-mt-md"})):f("",!0)]),_:1})]),_:1},8,["class"]))])])])]),_:1}))}}),pt=se(Ue,[["__scopeId","data-v-8d8280e9"]]);export{pt as default};
