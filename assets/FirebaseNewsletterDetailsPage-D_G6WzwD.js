import{v as W,r as _,f as g,_ as X,x as v,B as i,ag as Z,l as c,G as t,C as a,E as u,F as b,a5 as y,N as r,D as d,H as n,ac as q,M as m,a4 as ee,J as B,K as z,z as D,a3 as te,a2 as se,y as o}from"./index-DsgKP-0L.js";import{u as le,Q as ae}from"./useFirebaseNewsletterArchive-DLFR381t.js";import{Q as oe}from"./QImg-BZTFTqRc.js";import{Q as A}from"./QBadge-C89S7aDO.js";import{Q as ne}from"./QChip-D7qQyMGX.js";import{Q as ie}from"./QPage-yyDmDMQV.js";import{u as re}from"./site-store-simple-610guTgK.js";import{_ as de}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./firebase-newsletter.service-CNSfdROF.js";import"./firebase-firestore.service-DV1lPEDP.js";import"./firebase-auth.service-03qodj7b.js";import"./firebase-storage.service-DFtnWO6B.js";import"./useUserSettings-dZZXJFiW.js";const ue={class:"q-pa-md"},me={class:"row justify-center"},ce={class:"col-12 col-md-10 col-lg-8"},ve={key:0,class:"row justify-center q-pa-lg"},fe={class:"text-h6"},ge={class:"q-mb-none"},we={key:2},_e={class:"row"},pe={class:"col-12 col-md-4 q-pa-md"},be={class:"thumbnail-container"},ye={class:"absolute-center"},qe={key:1,class:"thumbnail-fallback-large"},he={class:"q-mt-md"},ke={class:"col-12 col-md-8 q-pa-md"},xe={class:"row items-start q-mb-md"},Ne={class:"col"},De={class:"text-h4 q-my-none"},Fe={key:0,class:"text-subtitle1 text-grey-6 q-mt-xs"},Se={class:"col-auto"},Ce={class:"publication-info q-mb-md"},Ue={class:"info-item"},Qe={key:0,class:"info-item"},Te={class:"info-item"},Be={class:"file-info q-mb-md"},ze={class:"info-item"},Ae={class:"info-item"},Le={class:"info-item"},Pe={key:0,class:"description q-mb-md"},Ee={class:"text-body1"},Ie={key:1,class:"tags-section"},$e={class:"row"},Re={class:"col-12 col-md-6 q-pa-md"},Me={class:"info-group"},Ve={class:"info-item"},je={key:0,class:"info-item"},He={class:"col-12 col-md-6 q-pa-md"},Ke={class:"info-group"},Ge={class:"info-item"},Je={class:"info-item"},Ye={key:0,class:"q-mt-md"},Oe={class:"info-item"},We={class:"row"},Xe={class:"text-subtitle2"},Ze={class:"text-caption text-grey-6"},et={key:3,class:"text-center q-pa-lg"},tt=W({__name:"FirebaseNewsletterDetailsPage",setup(st){const L=Z(),F=se(),p=te(),P=re(),{getNewsletterById:E,newsletters:I}=le(),s=_(null),h=_(!1),w=_(null),S=_(!1),k=_(!1),x=_(!1),C=g(()=>P.isDarkMode),N=g(()=>C.value?"bg-dark text-white q-dark":"bg-white text-dark"),$=g(()=>{if(!s.value)return"";const l=new Date(s.value.publicationDate);return isNaN(l.getTime())?"Date unknown":l.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}),R=g(()=>{if(!s.value?.fileSize)return"Unknown";const l=s.value.fileSize;return l<1024?`${l} B`:l<1024*1024?`${(l/1024).toFixed(1)} KB`:`${(l/(1024*1024)).toFixed(1)} MB`}),M=g(()=>{if(!s.value?.createdAt)return"Unknown";const l=new Date(s.value.createdAt);return isNaN(l.getTime())?"Unknown":l.toLocaleDateString("en-US")}),V=g(()=>{if(!s.value?.updatedAt)return"Unknown";const l=new Date(s.value.updatedAt);return isNaN(l.getTime())?"Unknown":l.toLocaleDateString("en-US")}),U=g(()=>s.value?I.value.filter(l=>l.id!==s.value.id&&l.year===s.value.year).slice(0,3):[]),j=l=>l.charAt(0).toUpperCase()+l.slice(1),H=l=>{const e=new Date(l);return isNaN(e.getTime())?"Date unknown":e.toLocaleDateString("en-US",{year:"numeric",month:"short"})},Q=async()=>{const l=L.params.id;if(!l){w.value="Newsletter ID is required";return}try{h.value=!0,w.value=null,c.info("Loading newsletter from Firebase:",l);const e=await E(l);e?(s.value=e,c.success("Newsletter loaded successfully:",e.title)):(w.value="Newsletter not found",c.warn("Newsletter not found:",l))}catch(e){w.value=e instanceof Error?e.message:"Failed to load newsletter",c.error("Error loading newsletter:",e)}finally{h.value=!1}},K=()=>{Q()},G=()=>{if(!s.value?.downloadUrl){p.notify({type:"negative",message:"PDF not available for viewing"});return}try{k.value=!0,window.open(s.value.downloadUrl,"_blank"),c.info("Newsletter opened for viewing:",s.value.title)}catch(l){c.error("Error opening newsletter:",l),p.notify({type:"negative",message:"Failed to open PDF"})}finally{k.value=!1}},J=()=>{if(!s.value?.downloadUrl){p.notify({type:"negative",message:"Download not available"});return}try{x.value=!0;const l=document.createElement("a");l.href=s.value.downloadUrl,l.download=s.value.filename,l.target="_blank",document.body.appendChild(l),l.click(),document.body.removeChild(l),p.notify({type:"positive",message:`Downloading ${s.value.title}`}),c.info("Newsletter download started:",s.value.filename)}catch(l){c.error("Error downloading newsletter:",l),p.notify({type:"negative",message:"Failed to download PDF"})}finally{x.value=!1}},Y=l=>{F.push(`/archive/${l}`)},T=()=>{F.push("/archive")},O=()=>{S.value=!0,c.warn("Thumbnail failed to load for:",s.value?.title)};return X(()=>{Q()}),(l,e)=>(o(),v(ie,{padding:""},{default:i(()=>[t("div",ue,[t("div",me,[t("div",ce,[a(b,{flat:"",icon:"mdi-arrow-left",label:"Back to Archive",onClick:T,class:"q-mb-md",color:C.value?"white":"primary"},null,8,["color"]),h.value?(o(),u("div",ve,[a(ae,{color:"primary",size:"3rem"}),e[0]||(e[0]=t("div",{class:"text-body1 q-ml-md"},"Loading newsletter from Firebase...",-1))])):w.value?(o(),v(y,{key:1,flat:"",bordered:"",class:"q-mb-md bg-negative text-white"},{default:i(()=>[a(q,null,{default:i(()=>[t("div",fe,[a(d,{name:"error",class:"q-mr-sm"}),e[1]||(e[1]=r(" Error Loading Newsletter ",-1))]),t("p",ge,n(w.value),1),a(b,{flat:"",color:"white",label:"Retry",onClick:K,class:"q-mt-sm"})]),_:1})]),_:1})):s.value?(o(),u("div",we,[a(y,{flat:"",class:D([N.value,"q-mb-md"])},{default:i(()=>[a(q,null,{default:i(()=>[t("div",_e,[t("div",pe,[t("div",be,[s.value.thumbnailUrl&&!S.value?(o(),v(oe,{key:0,src:s.value.thumbnailUrl,alt:`Thumbnail for ${s.value.title}`,class:"thumbnail-large",onError:O},{loading:i(()=>[t("div",ye,[a(ee,{color:"primary",size:"3em"})])]),_:1},8,["src","alt"])):(o(),u("div",qe,[a(d,{name:"mdi-file-pdf-box",size:"6rem",class:"text-grey-5"}),e[2]||(e[2]=t("div",{class:"text-h6 text-center q-mt-md"},"PDF Document",-1))]))]),t("div",he,[a(b,{color:"primary",icon:"visibility",label:"View PDF",onClick:G,loading:k.value,class:"full-width"},null,8,["loading"]),s.value.downloadUrl?(o(),v(b,{key:0,color:"secondary",icon:"download",label:"Download",onClick:J,loading:x.value,class:"full-width"},null,8,["loading"])):m("",!0)])]),t("div",ke,[t("div",xe,[t("div",Ne,[t("h1",De,n(s.value.title),1),s.value.issueNumber?(o(),u("div",Fe," Issue "+n(s.value.issueNumber),1)):m("",!0)]),t("div",Se,[s.value.featured?(o(),v(A,{key:0,color:"accent",rounded:""},{default:i(()=>[a(d,{name:"star",size:"14px",class:"q-mr-xs"}),e[3]||(e[3]=r(" Featured ",-1))]),_:1,__:[3]})):m("",!0),s.value.isPublished?m("",!0):(o(),v(A,{key:1,color:"orange",rounded:"",class:"q-ml-xs"},{default:i(()=>e[4]||(e[4]=[r(" Draft ",-1)])),_:1,__:[4]}))])]),t("div",Ce,[t("div",Ue,[a(d,{name:"event",class:"q-mr-sm"}),e[5]||(e[5]=t("strong",null,"Published:",-1)),r(" "+n($.value),1)]),s.value.season?(o(),u("div",Qe,[a(d,{name:"wb_sunny",class:"q-mr-sm"}),e[6]||(e[6]=t("strong",null,"Season:",-1)),r(" "+n(j(s.value.season)),1)])):m("",!0),t("div",Te,[a(d,{name:"calendar_today",class:"q-mr-sm"}),e[7]||(e[7]=t("strong",null,"Year:",-1)),r(" "+n(s.value.year),1)])]),t("div",Be,[t("div",ze,[a(d,{name:"description",class:"q-mr-sm"}),e[8]||(e[8]=t("strong",null,"Pages:",-1)),r(" "+n(s.value.pageCount||"Unknown"),1)]),t("div",Ae,[a(d,{name:"file_copy",class:"q-mr-sm"}),e[9]||(e[9]=t("strong",null,"Size:",-1)),r(" "+n(R.value),1)]),t("div",Le,[a(d,{name:"insert_drive_file",class:"q-mr-sm"}),e[10]||(e[10]=t("strong",null,"Filename:",-1)),r(" "+n(s.value.filename),1)])]),s.value.description?(o(),u("div",Pe,[e[11]||(e[11]=t("div",{class:"text-subtitle2 q-mb-sm"},"Description",-1)),t("div",Ee,n(s.value.description),1)])):m("",!0),s.value.tags&&s.value.tags.length>0?(o(),u("div",Ie,[e[12]||(e[12]=t("div",{class:"text-subtitle2 q-mb-sm"},"Tags",-1)),(o(!0),u(B,null,z(s.value.tags,f=>(o(),v(ne,{key:f,color:"primary","text-color":"white",class:"q-mr-sm q-mb-sm"},{default:i(()=>[r(n(f),1)]),_:2},1024))),128))])):m("",!0)])])]),_:1})]),_:1},8,["class"]),a(y,{flat:"",class:D([N.value,"q-mb-md"])},{default:i(()=>[a(q,null,{default:i(()=>[e[22]||(e[22]=t("div",{class:"text-h6 q-mb-md"},"Newsletter Information",-1)),t("div",$e,[t("div",Re,[t("div",Me,[e[16]||(e[16]=t("div",{class:"text-subtitle2 q-mb-sm"},"Storage Information",-1)),t("div",Ve,[a(d,{name:"cloud",class:"q-mr-sm"}),e[13]||(e[13]=t("strong",null,"Storage:",-1)),e[14]||(e[14]=r(" Firebase Cloud Storage ",-1))]),s.value.storageRef?(o(),u("div",je,[a(d,{name:"folder",class:"q-mr-sm"}),e[15]||(e[15]=t("strong",null,"Path:",-1)),r(" "+n(s.value.storageRef),1)])):m("",!0)])]),t("div",He,[t("div",Ke,[e[19]||(e[19]=t("div",{class:"text-subtitle2 q-mb-sm"},"Timestamps",-1)),t("div",Ge,[a(d,{name:"add",class:"q-mr-sm"}),e[17]||(e[17]=t("strong",null,"Created:",-1)),r(" "+n(M.value),1)]),t("div",Je,[a(d,{name:"edit",class:"q-mr-sm"}),e[18]||(e[18]=t("strong",null,"Updated:",-1)),r(" "+n(V.value),1)])])])]),s.value.searchableText?(o(),u("div",Ye,[e[21]||(e[21]=t("div",{class:"text-subtitle2 q-mb-sm"},"Content Analysis",-1)),t("div",Oe,[a(d,{name:"search",class:"q-mr-sm"}),e[20]||(e[20]=t("strong",null,"Full-text Search:",-1)),r(" Available ("+n(s.value.searchableText.length.toLocaleString())+" characters indexed) ",1)])])):m("",!0)]),_:1,__:[22]})]),_:1},8,["class"]),U.value.length>0?(o(),v(y,{key:0,flat:"",class:D(N.value)},{default:i(()=>[a(q,null,{default:i(()=>[e[23]||(e[23]=t("div",{class:"text-h6 q-mb-md"},"Related Newsletters",-1)),t("div",We,[(o(!0),u(B,null,z(U.value,f=>(o(),u("div",{key:f.id,class:"col-12 col-sm-6 col-md-4 q-pa-sm"},[a(y,{flat:"",bordered:"",class:"cursor-pointer",onClick:lt=>Y(f.id)},{default:i(()=>[a(q,{class:"q-pa-md"},{default:i(()=>[t("div",Xe,n(f.title),1),t("div",Ze,n(H(f.publicationDate)),1)]),_:2},1024)]),_:2},1032,["onClick"])]))),128))])]),_:1,__:[23]})]),_:1},8,["class"])):m("",!0)])):(o(),u("div",et,[a(d,{name:"search_off",size:"4rem",class:"text-grey-5"}),e[24]||(e[24]=t("div",{class:"text-h6 q-mt-md text-grey-6"},"Newsletter Not Found",-1)),e[25]||(e[25]=t("div",{class:"text-body1 q-mt-sm text-grey-6"}," The requested newsletter could not be found in our Firebase database. ",-1)),a(b,{color:"primary",label:"Back to Archive",onClick:T,class:"q-mt-md"})]))])])])]),_:1}))}}),_t=de(tt,[["__scopeId","data-v-3f26906a"]]);export{_t as default};
