import{v as Ce,a3 as Ue,r as A,f as _,x as y,y as o,a5 as Z,az as ne,ad as Oe,z as T,a6 as K,B as d,G as s,C as r,E as c,M as m,a4 as qe,D as g,F as k,N as v,I as e,H as i,J as B,K as G,ac as j,l as N,w as we,_ as Pe,Q as Me,L as ze,aa as Ve,a8 as Le,aw as se}from"./index-C_JkpTYA.js";import{Q as C}from"./QChip-pZEp0y1J.js";import{Q as ae}from"./QSpace-Cx1rzqTo.js";import{Q as M}from"./QTooltip-CP8m_Pmp.js";import{Q as re}from"./QSelect-D2dFKaVT.js";import{Q as Qe}from"./QSlideTransition-Bh093xlC.js";import{Q as He}from"./QBtnToggle-DD8zqNv1.js";import{u as Be,Q as Ye}from"./useFirebaseNewsletterArchive-DVG3gtUb.js";import{Q as Ie}from"./QPage-Df4pcqfM.js";import{u as Ae}from"./site-store-simple-Dpt8jODH.js";import{Q as We}from"./QImg-CcqjdU3Y.js";import{Q as Ke}from"./QBadge-DwFIcqT9.js";import{Q as Ge}from"./QInnerLoading-BWHmgsm_.js";import{firestoreService as ke}from"./firebase-firestore.service-DPj3Rf11.js";import{T as b}from"./translation-keys-CcbP-t_8.js";import{u as De}from"./vue-i18n.runtime-BJBTxLQE.js";import{_ as Fe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as je}from"./useRoleAuth-vpDjdBsR.js";import"./QMenu-Dh3ZC5pK.js";import"./format-DFNAs745.js";import"./QItem-D71Clo6b.js";import"./QBtnGroup-CnpgbsFn.js";import"./firebase-newsletter.service-D7ooak-t.js";import"./firebase-storage.service-is7ocZr7.js";import"./firebase-auth.service-DUJ5rzAl.js";import"./useUserSettings-DnMlxD9P.js";import"./useFirebase-Dw-FPQcY.js";const Je=["aria-label"],Xe={class:"absolute-center"},Ze={class:"accessibility-indicators absolute-top-right q-pa-xs"},et={class:"text-subtitle1 text-weight-medium newsletter-title q-mb-xs",role:"heading","aria-level":"3"},tt={class:"text-caption text-grey-6 q-mb-sm"},lt=["datetime","aria-label"],st={key:0,class:"q-ml-sm"},at={key:0,class:"text-caption text-grey-6 q-mb-sm"},rt=["aria-label"],ot={key:2,class:"q-mb-sm",role:"list","aria-label":"Tags"},nt={class:"row items-center text-caption text-grey-6"},it={class:"col"},dt=["aria-label"],ut={key:1},ct=["aria-label"],mt={class:"col-auto",role:"group","aria-label":"Newsletter actions"},oe=2,Ne=100,vt=Ce({__name:"FirebaseNewsletterCard",props:{newsletter:{},showAdminControls:{type:Boolean}},emits:["metadataUpdated","newsletterDeleted","refreshNeeded"],setup(he,{emit:J}){const t=he,Y=J,{t:D}=De(),S=Ue(),ie=Ae(),q=A(!1),de=A(!1),z=A(!1),I=A(!1),p=A(!1),ee=_(()=>ie.isDarkMode),$=_(()=>{const l="newsletter-card";return ee.value?`${l} bg-dark text-white q-dark`:`${l} bg-white text-dark`}),ue=_(()=>({height:"100%",display:"flex",flexDirection:"column"})),F=_(()=>t.showAdminControls??!1),V=_(()=>({flex:!0,"flex-center":!0,column:!0,"full-height":!0,"bg-grey":!ee.value})),L=_(()=>{if(t.newsletter.displayDate)return t.newsletter.displayDate;const l=new Date(t.newsletter.publicationDate);return isNaN(l.getTime())?"Date unknown":l.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}),W=_(()=>{if(!t.newsletter.fileSize)return"";const l=t.newsletter.fileSize;return l<1024?`${l} B`:l<1024*1024?`${(l/1024).toFixed(1)} KB`:`${(l/(1024*1024)).toFixed(1)} MB`}),ce=_(()=>t.newsletter.description?t.newsletter.description.length<=Ne?t.newsletter.description:t.newsletter.description.substring(0,Ne)+"...":""),me=_(()=>t.newsletter.tags?t.newsletter.tags.slice(0,oe):[]),ve=l=>l.charAt(0).toUpperCase()+l.slice(1),O=()=>{Q()},Q=()=>{if(!t.newsletter.downloadUrl){S.notify({type:"negative",message:"PDF not available for viewing"});return}try{q.value=!0,N.info("Opening newsletter:",t.newsletter.title),window.open(t.newsletter.downloadUrl,"_blank")}catch(l){N.error("Error opening newsletter:",l),S.notify({type:"negative",message:"Failed to open PDF"})}finally{q.value=!1}},h=()=>{if(!t.newsletter.downloadUrl){S.notify({type:"negative",message:"Download not available"});return}try{q.value=!0;const l=document.createElement("a");l.href=t.newsletter.downloadUrl,l.download=t.newsletter.filename,l.target="_blank",document.body.appendChild(l),l.click(),document.body.removeChild(l),S.notify({type:"positive",message:`Downloading ${t.newsletter.title}`}),N.info("Newsletter download started:",t.newsletter.filename)}catch(l){N.error("Error downloading newsletter:",l),S.notify({type:"negative",message:"Failed to download PDF"})}finally{q.value=!1}},R=()=>{de.value=!0,N.warn("Thumbnail failed to load for:",t.newsletter.title)},P=()=>{try{p.value=!0,S.notify({type:"warning",message:"Thumbnail generation disabled",caption:"PDF processing functionality removed"})}catch(l){N.error("Error generating thumbnail:",l),S.notify({type:"negative",message:"Failed to generate thumbnail",position:"top"})}finally{p.value=!1}},be=async()=>{try{z.value=!0;const l=t.newsletter.isPublished===!0,w=!l;N.info(`Toggling publication status: ${l} -> ${w} for newsletter ${t.newsletter.id}`);try{await ke.updateNewsletterMetadata(t.newsletter.id,{isPublished:w})}catch(U){if(U instanceof Error&&U.message.includes("No document to update")){N.warn("Document does not exist, requesting parent to sync first..."),Y("refreshNeeded"),S.notify({type:"warning",message:"Newsletter needs to be synced to Firebase first",caption:"Please use the sync button to create the Firebase record",position:"top"});return}else throw U}const E=t.newsletter;E.isPublished=w,Y("metadataUpdated",t.newsletter.id,{isPublished:w}),S.notify({type:"positive",message:`Newsletter ${w?"published":"unpublished"} successfully`,position:"top"}),N.info(`Newsletter ${t.newsletter.id} ${w?"published":"unpublished"}`)}catch(l){N.error("Error toggling publish status:",l),S.notify({type:"negative",message:"Failed to update publication status",caption:l instanceof Error?l.message:"Unknown error",position:"top"})}finally{z.value=!1}},u=async()=>{try{I.value=!0;const l=t.newsletter.featured===!0,w=!l;N.info(`Toggling featured status: ${l} -> ${w} for newsletter ${t.newsletter.id}`);try{await ke.updateNewsletterMetadata(t.newsletter.id,{featured:w})}catch(U){if(U instanceof Error&&U.message.includes("No document to update")){N.warn("Document does not exist, requesting parent to sync first..."),Y("refreshNeeded"),S.notify({type:"warning",message:"Newsletter needs to be synced to Firebase first",caption:"Please use the sync button to create the Firebase record",position:"top"});return}else throw U}const E=t.newsletter;E.featured=w,Y("metadataUpdated",t.newsletter.id,{featured:w}),S.notify({type:"positive",message:`Newsletter ${w?"added to featured":"removed from featured"}`,position:"top"}),N.info(`Newsletter ${t.newsletter.id} featured status: ${w}`)}catch(l){N.error("Error toggling featured status:",l),S.notify({type:"negative",message:"Failed to update featured status",position:"top"})}finally{I.value=!1}};return(l,w)=>(o(),y(Z,{flat:"",bordered:"",class:T([$.value,"newsletter-card cursor-pointer transition-all"]),onClick:O,style:Oe(ue.value),tabindex:0,onKeydown:[ne(O,["enter"]),ne(K(O,["prevent"]),["space"])],role:"article","aria-label":"Newsletter: "+l.newsletter.title+", published "+L.value+(l.newsletter.description?", "+l.newsletter.description:"")},{default:d(()=>[s("div",{class:"thumbnail-container",role:"img","aria-label":l.newsletter.thumbnailUrl?"Newsletter thumbnail":"PDF document icon"},[l.newsletter.thumbnailUrl?(o(),y(We,{key:0,src:l.newsletter.thumbnailUrl,alt:"Thumbnail preview for "+l.newsletter.title,class:"thumbnail-image",loading:"lazy",onError:R,position:"top"},{loading:d(()=>[s("div",Xe,[r(qe,{color:"primary",size:"2em"})])]),_:1},8,["src","alt"])):(o(),c("div",{key:1,class:T(["thumbnail-fallback",V.value])},[r(g,{name:"mdi-file-pdf-box",size:"3rem",class:"text-grey-5"}),w[1]||(w[1]=s("div",{class:"text-caption text-center q-mt-xs"},"PDF",-1)),F.value&&!l.newsletter.thumbnailUrl?(o(),y(k,{key:0,flat:"",dense:"",size:"sm",color:"primary",icon:"image",class:"q-mt-xs",onClick:K(P,["stop"]),loading:p.value},{default:d(()=>[r(M,null,{default:d(()=>w[0]||(w[0]=[v("Generate Thumbnail",-1)])),_:1,__:[0]})]),_:1},8,["loading"])):m("",!0)],2)),l.newsletter.featured?(o(),y(Ke,{key:2,color:"accent",floating:"",rounded:"",class:"featured-badge","aria-label":e(D)(e(b).CONTENT.ACTIONS.FEATURE),style:{top:"8px",right:"8px"}},{default:d(()=>[r(g,{name:"star",size:"12px",class:"q-mr-xs"}),v(" "+i(e(D)(e(b).FORMS.FEATURED)),1)]),_:1},8,["aria-label"])):m("",!0),s("div",Ze,[l.newsletter.description?(o(),y(g,{key:0,name:"description",size:"16px",class:"text-positive q-mr-xs","aria-label":"Has description for screen readers"},{default:d(()=>[r(M,null,{default:d(()=>w[2]||(w[2]=[v("Has description",-1)])),_:1,__:[2]})]),_:1})):m("",!0),l.newsletter.searchableText?(o(),y(g,{key:1,name:"search",size:"16px",class:"text-info","aria-label":"Text content is searchable"},{default:d(()=>[r(M,null,{default:d(()=>w[3]||(w[3]=[v("Searchable content",-1)])),_:1,__:[3]})]),_:1})):m("",!0)])],8,Je),r(j,{class:"newsletter-content"},{default:d(()=>[s("div",et,i(l.newsletter.title),1),s("div",tt,[r(g,{name:"event",size:"14px",class:"q-mr-xs"}),s("time",{datetime:l.newsletter.publicationDate,"aria-label":"Published on "+L.value},i(L.value),9,lt),l.newsletter.season?(o(),c("span",st,[r(g,{name:"wb_sunny",size:"14px",class:"q-mr-xs"}),v(" "+i(ve(l.newsletter.season)),1)])):m("",!0)]),l.newsletter.issueNumber?(o(),c("div",at,[r(g,{name:"numbers",size:"14px",class:"q-mr-xs"}),v(" "+i(e(D)(e(b).NEWSLETTER.ISSUE))+" "+i(l.newsletter.issueNumber),1)])):m("",!0),l.newsletter.description?(o(),c("div",{key:1,class:"text-body2 newsletter-description q-mb-sm","aria-label":"Description: "+l.newsletter.description},i(ce.value),9,rt)):m("",!0),l.newsletter.tags&&l.newsletter.tags.length>0?(o(),c("div",ot,[(o(!0),c(B,null,G(me.value,E=>(o(),y(C,{key:E,size:"sm",color:"primary","text-color":"white",dense:"",class:"q-mr-xs q-mb-xs",role:"listitem","aria-label":"Tag: "+E},{default:d(()=>[v(i(E),1)]),_:2},1032,["aria-label"]))),128)),l.newsletter.tags.length>oe?(o(),y(C,{key:0,size:"sm",color:"grey","text-color":"white",dense:"",class:"q-mr-xs q-mb-xs","aria-label":"And "+(l.newsletter.tags.length-oe)+" more tags"},{default:d(()=>[v(" +"+i(l.newsletter.tags.length-oe),1)]),_:1},8,["aria-label"])):m("",!0)])):m("",!0)]),_:1}),r(j,{class:"newsletter-footer q-pt-none"},{default:d(()=>[s("div",nt,[s("div",it,[r(g,{name:"description",size:"14px",class:"q-mr-xs"}),l.newsletter.pageCount?(o(),c("span",{key:0,"aria-label":l.newsletter.pageCount+" "+e(D)(e(b).NEWSLETTER.PAGE_COUNT)},i(l.newsletter.pageCount)+" "+i(l.newsletter.pageCount===1?e(D)(e(b).NEWSLETTER.PAGE_COUNT).slice(0,-1):e(D)(e(b).NEWSLETTER.PAGE_COUNT)),9,dt)):(o(),c("span",ut,"PDF")),W.value?(o(),c("span",{key:2,class:"q-ml-sm","aria-label":"File size: "+W.value}," • "+i(W.value),9,ct)):m("",!0)]),s("div",mt,[F.value?(o(),c(B,{key:0},[r(k,{flat:"",dense:"",round:"",size:"sm",color:l.newsletter.isPublished===!0?"positive":"orange",icon:l.newsletter.isPublished===!0?"visibility":"visibility_off",onClick:K(be,["stop"]),"aria-label":(l.newsletter.isPublished===!0?"Unpublish":"Publish")+" newsletter: "+l.newsletter.title,tabindex:0,loading:z.value},{default:d(()=>[r(M,null,{default:d(()=>[v(i(l.newsletter.isPublished===!0?"Unpublish":"Publish")+" Newsletter",1)]),_:1})]),_:1},8,["color","icon","aria-label","loading"]),r(k,{flat:"",dense:"",round:"",size:"sm",color:l.newsletter.featured===!0?"accent":"grey",icon:l.newsletter.featured===!0?"star":"star_border",onClick:K(u,["stop"]),"aria-label":(l.newsletter.featured===!0?"Remove from featured":"Add to featured")+" newsletter: "+l.newsletter.title,tabindex:0,loading:I.value},{default:d(()=>[r(M,null,{default:d(()=>[v(i(l.newsletter.featured?"Remove from Featured":"Add to Featured"),1)]),_:1})]),_:1},8,["color","icon","aria-label","loading"]),r(k,{flat:"",dense:"",round:"",size:"sm",color:"primary",icon:"open_in_new",onClick:K(Q,["stop"]),"aria-label":"View newsletter: "+l.newsletter.title,tabindex:0},{default:d(()=>[r(M,null,{default:d(()=>w[4]||(w[4]=[v("View PDF",-1)])),_:1,__:[4]})]),_:1},8,["aria-label"]),l.newsletter.downloadUrl?(o(),y(k,{key:0,flat:"",dense:"",round:"",size:"sm",color:"secondary",icon:"download",onClick:K(h,["stop"]),"aria-label":"Download newsletter: "+l.newsletter.title,tabindex:0},{default:d(()=>[r(M,null,{default:d(()=>w[5]||(w[5]=[v("Download PDF",-1)])),_:1,__:[5]})]),_:1},8,["aria-label"])):m("",!0)],64)):m("",!0)])])]),_:1}),r(Ge,{showing:q.value,color:"primary"},null,8,["showing"])]),_:1},8,["class","style","onKeydown","aria-label"]))}}),Ee=Fe(vt,[["__scopeId","data-v-59712ee9"]]),bt={class:"q-pa-md"},pt={class:"row justify-center"},wt={class:"col-12 col-md-10 col-lg-8"},ht={class:"text-h4 q-mb-md"},ft={class:"text-body1"},yt={key:0,class:"q-mt-md"},gt={class:"row text-center q-col-gutter-sm"},_t={class:"col"},St={class:"text-h6 text-primary"},xt={class:"text-caption"},Tt={class:"col"},kt={class:"text-h6 text-positive"},Nt={class:"text-caption"},Et={class:"col"},Ct={class:"text-h6 text-info"},qt={class:"text-caption"},At={class:"col"},Dt={class:"text-h6 text-secondary"},Ft={class:"text-caption"},$t={class:"row items-center q-mb-md"},Rt={class:"text-subtitle2 text-weight-medium q-mr-md"},Ut={key:0,class:"text-caption text-grey-6"},Ot={key:1,class:"text-caption text-primary"},Pt={class:"row q-mb-md"},Mt={class:"col-12 col-md-8 q-pa-md"},zt=["aria-label"],Vt={class:"text-caption text-grey-6 q-mt-xs"},Lt={key:0},Qt={class:"col-12 col-md-4 q-pa-md"},Ht={class:"row q-my-xs space-between q-gutter-sm"},Bt={class:"text-subtitle2 q-mb-md text-weight-medium"},Yt={class:"row q-mb-md"},It={class:"col-12 col-sm-6 col-md-3 q-pa-md"},Wt={class:"col-12 col-sm-6 col-md-3 q-pa-md"},Kt={class:"col-12 col-sm-6 col-md-3 q-pa-md"},Gt={class:"col-12 col-sm-6 col-md-3 q-pa-md"},jt={class:"row q-mb-md"},Jt={class:"col-12 col-sm-6 col-md-3 q-pa-md"},Xt={class:"col-12 col-sm-6 col-md-3 q-pa-md"},Zt={class:"col-12 col-sm-6 col-md-3 q-pa-md"},el={class:"col-12 col-sm-6 col-md-3 q-pa-md"},tl={key:0,class:"text-caption text-grey-6"},ll={class:"row items-center"},sl={key:0,class:"",role:"list","aria-label":"Active filters"},al={class:"row items-center q-mt-md"},rl={class:"col-auto"},ol={class:"col-auto q-mt-sm"},nl={class:"text-weight-medium"},il={key:0,class:"text-weight-medium text-primary"},dl={key:1,class:"q-ml-sm text-caption"},ul={key:0,class:"text-caption text-grey-6 q-mt-xs"},cl={key:0,class:"row justify-center q-pa-lg"},ml={class:"text-h6"},vl={class:"q-mb-none"},bl={key:2,class:"text-center q-pa-lg"},pl={key:0},wl={key:1},hl={key:2},fl={key:0,class:"q-mt-md"},yl={class:"row justify-center"},gl={key:1,class:"q-mt-md"},_l={class:"row justify-center"},Sl={key:3,class:"newsletter-grid"},xl={class:"row"},Tl={key:4},kl={class:"row items-center"},Nl={class:"text-h5 text-primary"},El={class:"newsletter-grid"},Cl={class:"row"},ql=Ce({__name:"FirebaseNewsletterArchivePage",setup(he){const J=Ae(),{t}=De(),{newsletters:Y,filteredNewsletters:D,sortedNewsletters:S,newslettersByYear:ie,searchResults:q,isLoading:de,isSearching:z,error:I,stats:p,hasResults:ee,hasActiveFilters:$,yearFilterOptions:ue,quickFilterOptions:F,loadNewsletters:V,debouncedSearch:L,updateFilters:W,clearFilters:ce,getSearchSuggestions:me,validateAccessibility:ve}=Be(),O=A(!1),Q=A(!1),h=A(""),R=A("date-desc"),P=A([]),be=A(null),u=A({year:null,month:null,pageCount:null,featured:!1,hasDescription:null,hasSearchableText:null,hasThumbnail:null}),l=_(()=>J.isDarkMode),w=_(()=>J.isDarkMode?"bg-dark text-white q-dark":"bg-white text-dark"),E=_(()=>J.isDarkMode?"text-grey-4":"text-grey-7"),{isEditor:U}=je(),H=_(()=>U.value),$e=_(()=>[{label:t(b.SEARCH.SORT_BY),value:"relevance"},{label:t(b.SEARCH.SORT_DATE_DESC),value:"date-desc"},{label:t(b.SEARCH.SORT_DATE_ASC),value:"date-asc"},{label:t(b.SEARCH.SORT_TITLE_ASC),value:"title-asc"},{label:t(b.SEARCH.SORT_TITLE_DESC),value:"title-desc"},{label:t("newsletter.sortMostPages")||"Most Pages",value:"pages-desc"},{label:t("newsletter.sortFewestPages")||"Fewest Pages",value:"pages-asc"}]),fe=_(()=>[{label:t(b.DATES.MONTHS.JANUARY),value:1},{label:t(b.DATES.MONTHS.FEBRUARY),value:2},{label:t(b.DATES.MONTHS.MARCH),value:3},{label:t(b.DATES.MONTHS.APRIL),value:4},{label:t(b.DATES.MONTHS.MAY),value:5},{label:t(b.DATES.MONTHS.JUNE),value:6},{label:t(b.DATES.MONTHS.JULY),value:7},{label:t(b.DATES.MONTHS.AUGUST),value:8},{label:t(b.DATES.MONTHS.SEPTEMBER),value:9},{label:t(b.DATES.MONTHS.OCTOBER),value:10},{label:t(b.DATES.MONTHS.NOVEMBER),value:11},{label:t(b.DATES.MONTHS.DECEMBER),value:12}]),ye=_(()=>[{label:t("newsletter.pages1to5")||"1-5 pages",value:"1-5"},{label:t("newsletter.pages6to10")||"6-10 pages",value:"6-10"},{label:t("newsletter.pages11to20")||"11-20 pages",value:"11-20"},{label:t("newsletter.pages20plus")||"20+ pages",value:"20+"}]),te=()=>{L(h.value)},x=()=>{const f={};u.value.year&&(f.year=u.value.year),u.value.month&&(f.month=u.value.month),u.value.pageCount&&(f.pageCount=u.value.pageCount),u.value.featured!==void 0&&(f.featured=u.value.featured),f.sortBy=R.value,W(f)},ge=()=>{W({sortBy:R.value})},pe=()=>{u.value={year:null,month:null,pageCount:null,featured:!1,hasDescription:null,hasSearchableText:null,hasThumbnail:null},h.value="",R.value="date-desc",P.value=[],ce()},_e=()=>{h.value.trim()&&L(h.value)},Se=f=>{h.value=f,P.value=[],L(f)},le=f=>{if(F.value){switch(pe(),f){case"featured":u.value.featured=!0;break;case"currentYear":u.value.year=new Date().getFullYear();break;case"recentlyAdded":R.value="date-desc";break}x()}};we(h,f=>{f&&f.length>=2?P.value=me(f):P.value=[]}),Pe(()=>{be.value=ve();const f=H.value;V(f)});const Re=()=>{const f=H.value;V(f)},xe=async(f,a)=>{const n=H.value;await V(n)},Te=async()=>{const f=H.value;await V(f)};return we(R,()=>{ge()}),we(H,async(f,a)=>{f!==a&&await V(f)}),(f,a)=>(o(),y(Ie,{padding:""},{default:d(()=>[s("div",bt,[s("div",pt,[s("div",wt,[r(Z,{flat:"",class:T([w.value,"q-mb-md"])},{default:d(()=>[r(j,null,{default:d(()=>[s("div",ht,[r(g,{name:"mdi-bookshelf",class:"q-mr-sm"}),v(" "+i(e(t)(e(b).NEWSLETTER.ARCHIVE)),1)]),s("p",ft,i(e(t)("newsletter.archiveDescription")||"Browse through past issues of The Courier with Firebase-powered search and filtering. All content is dynamically loaded from our cloud database with real-time updates."),1),e(p)?(o(),c("div",yt,[s("div",gt,[s("div",_t,[s("div",St,i(e(p).totalNewsletters),1),s("div",xt,i(e(t)("newsletter.totalIssues")||"Total Issues"),1)]),s("div",Tt,[s("div",kt,i(e(p).sourceCounts.firebase),1),s("div",Nt,i(e(t)("newsletter.firebaseStorage")||"Firebase Storage"),1)]),s("div",Et,[s("div",Ct,i(e(p).publishedThisYear),1),s("div",qt,i(e(t)("newsletter.publishedThisYear")||"Published This Year"),1)]),s("div",At,[s("div",Dt,i(e(p).availableYears.length),1),s("div",Ft,i(e(t)("newsletter.yearsAvailable")||"Years Available"),1)])])])):m("",!0)]),_:1})]),_:1},8,["class"]),r(Z,{flat:"",class:T([w.value,"q-mb-md"])},{default:d(()=>[r(j,null,{default:d(()=>[s("div",$t,[s("div",Rt,i(e(t)("newsletter.searchLabel")||"Newsletter search:"),1),r(C,{color:"primary","text-color":"white",icon:"cloud",size:"sm"},{default:d(()=>[v(i(e(t)("newsletter.realTimeDatabase")||"Real-time Cloud Database"),1)]),_:1}),r(ae),e(q)&&e(q).searchStats.indexedPdfs>0?(o(),c("div",Ut,i(e(t)("newsletter.pdfsIndexed",{count:e(q).searchStats.indexedPdfs})||`${e(q).searchStats.indexedPdfs} PDFs indexed`),1)):m("",!0),e(z)?(o(),c("div",Ot,[r(qe,{size:"14px",class:"q-mr-xs"}),v(" "+i(e(t)(e(b).SEARCH.SEARCHING)),1)])):m("",!0)]),s("div",Pt,[s("div",Mt,[r(Me,{modelValue:h.value,"onUpdate:modelValue":[a[1]||(a[1]=n=>h.value=n),te],label:e(t)(e(b).NEWSLETTER.SEARCH_CONTENT)||"Search newsletters by title, content, tags, year, or month...",outlined:"",dense:"",class:T({"bg-grey":!l.value}),clearable:"",loading:e(z),onKeydown:ne(_e,["enter"]),"aria-label":e(t)("newsletter.searchAriaLabel",{count:e(p)?.totalNewsletters||0})||`Search through ${e(p)?.totalNewsletters||0} newsletters`,role:"searchbox","aria-expanded":"false","aria-describedby":h.value?"search-suggestions":null},{prepend:d(()=>[r(g,{name:"find_in_page"})]),append:d(()=>[!e(z)&&h.value?(o(),y(k,{key:0,flat:"",dense:"",round:"",icon:"send",onClick:_e,"aria-label":e(t)("newsletter.searchFor",{query:h.value})||`Search for: ${h.value}`},null,8,["aria-label"])):m("",!0),r(k,{flat:"",dense:"",round:"",icon:"tune",onClick:a[0]||(a[0]=n=>O.value=!O.value),color:"primary"},{default:d(()=>[r(M,null,{default:d(()=>[v(i(O.value?e(t)(e(b).COMMON.CLOSE):e(t)(e(b).COMMON.OPEN))+" "+i(e(t)(e(b).SEARCH.FILTERS)),1)]),_:1})]),_:1})]),_:1},8,["modelValue","label","class","loading","aria-label","aria-describedby"]),P.value.length>0&&h.value?(o(),c("div",{key:0,id:"search-suggestions",class:"q-mt-xs",role:"listbox","aria-label":e(t)("newsletter.searchSuggestions")||"Search suggestions"},[(o(!0),c(B,null,G(P.value,n=>(o(),y(C,{key:n,clickable:"",size:"sm",color:"grey-3","text-color":"dark",class:"q-mr-xs q-mb-xs",onClick:X=>Se(n),tabindex:0,onKeydown:ne(X=>Se(n),["enter"]),role:"option"},{default:d(()=>[r(g,{name:"lightbulb",size:"14px",class:"q-mr-xs"}),v(" "+i(n),1)]),_:2},1032,["onClick","onKeydown"]))),128))],8,zt)):m("",!0),s("div",Vt,[v(i(e(t)("newsletter.poweredByFirebase")||"Powered by Firebase Firestore with real-time updates and full-text search")+" ",1),e(p)?.accessibility?(o(),c("span",Lt," • "+i(e(t)("newsletter.searchableTextCount",{searchable:e(p).accessibility.withSearchableText,total:e(p).totalNewsletters})||`${e(p).accessibility.withSearchableText} of ${e(p).totalNewsletters} have searchable text`),1)):m("",!0)])]),s("div",Qt,[r(re,{modelValue:R.value,"onUpdate:modelValue":[a[2]||(a[2]=n=>R.value=n),ge],options:$e.value,label:e(t)(e(b).SEARCH.SORT_BY),outlined:"",dense:"","emit-value":"","map-options":"",class:T({"bg-grey":!l.value}),"aria-label":e(t)("newsletter.sortAriaLabel")||"Sort newsletters by different criteria"},{prepend:d(()=>[r(g,{name:"sort"})]),_:1},8,["modelValue","options","label","class","aria-label"]),s("div",Ht,[r(k,{outline:"",color:"primary",size:"sm",onClick:a[3]||(a[3]=n=>le("featured")),label:e(t)("newsletter.featured")+" ("+(e(F)?.featured?.length||0)+")","aria-label":e(t)("newsletter.featuredAriaLabel",{count:e(F)?.featured?.length||0})||`Show only featured newsletters, ${e(F)?.featured?.length||0} available`},null,8,["label","aria-label"]),r(k,{outline:"",color:"secondary",size:"sm",onClick:a[4]||(a[4]=n=>le("currentYear")),label:e(t)("newsletter.thisYear")+" ("+(e(F)?.currentYear?.length||0)+")","aria-label":e(t)("newsletter.thisYearAriaLabel",{count:e(F)?.currentYear?.length||0})||`Show current year newsletters, ${e(F)?.currentYear?.length||0} available`},null,8,["label","aria-label"]),r(k,{outline:"",color:"accent",size:"sm",onClick:a[5]||(a[5]=n=>le("recentlyAdded")),label:e(t)("newsletter.recent")||"Recent","aria-label":e(t)("newsletter.recentAriaLabel")||"Show recently added newsletters"},null,8,["label","aria-label"])])])]),r(Qe,null,{default:d(()=>[ze(s("div",null,[r(Le,{class:"q-mb-md"}),s("div",Bt,[r(g,{name:"filter_list",class:"q-mr-xs"}),v(" "+i(e(t)(e(b).SEARCH.FILTERS)),1)]),s("div",Yt,[s("div",It,[r(re,{modelValue:u.value.year,"onUpdate:modelValue":[a[6]||(a[6]=n=>u.value.year=n),x],options:e(ue),label:e(t)("forms.year")||"Year",outlined:"",dense:"",clearable:"","emit-value":"","map-options":"",class:T({"bg-grey":!l.value})},{prepend:d(()=>[r(g,{name:"event"})]),_:1},8,["modelValue","options","label","class"])]),s("div",Wt,[r(re,{modelValue:u.value.month,"onUpdate:modelValue":[a[7]||(a[7]=n=>u.value.month=n),x],options:fe.value,label:e(t)("forms.month")||"Month",outlined:"",dense:"",clearable:"","emit-value":"","map-options":"",class:T({"bg-grey":!l.value})},{prepend:d(()=>[r(g,{name:"calendar_month"})]),_:1},8,["modelValue","options","label","class"])]),s("div",Kt,[r(re,{modelValue:u.value.pageCount,"onUpdate:modelValue":[a[8]||(a[8]=n=>u.value.pageCount=n),x],options:ye.value,label:e(t)(e(b).NEWSLETTER.PAGE_COUNT),outlined:"",dense:"",clearable:"","emit-value":"","map-options":"",class:T({"bg-grey":!l.value})},{prepend:d(()=>[r(g,{name:"description"})]),_:1},8,["modelValue","options","label","class"])]),s("div",Gt,[r(se,{modelValue:u.value.featured,"onUpdate:modelValue":[a[9]||(a[9]=n=>u.value.featured=n),x],label:e(t)("newsletter.featuredOnly")||"Featured Only",color:"primary","aria-label":e(t)("newsletter.featuredOnlyAriaLabel")||"Show only featured newsletters"},null,8,["modelValue","label","aria-label"])])]),s("div",jt,[s("div",Jt,[r(se,{modelValue:u.value.hasDescription,"onUpdate:modelValue":[a[10]||(a[10]=n=>u.value.hasDescription=n),x],label:"With Descriptions",color:"purple","aria-label":"Show only newsletters with descriptions for screen readers"},null,8,["modelValue"])]),s("div",Xt,[r(se,{modelValue:u.value.hasSearchableText,"onUpdate:modelValue":[a[11]||(a[11]=n=>u.value.hasSearchableText=n),x],label:"Text Searchable",color:"orange","aria-label":"Show only newsletters with searchable text content"},null,8,["modelValue"])]),s("div",Zt,[r(se,{modelValue:u.value.hasThumbnail,"onUpdate:modelValue":[a[12]||(a[12]=n=>u.value.hasThumbnail=n),x],label:"With Thumbnails",color:"teal","aria-label":"Show only newsletters with preview thumbnails"},null,8,["modelValue"])]),s("div",el,[e(p)?.accessibility?(o(),c("div",tl,[a[24]||(a[24]=s("div",null,[s("strong",null,"Accessibility:")],-1)),s("div",null,i(e(p).accessibility.withDescriptions)+"/"+i(e(p).totalNewsletters)+" descriptions",1),s("div",null,i(e(p).accessibility.withSearchableText)+"/"+i(e(p).totalNewsletters)+" searchable",1),s("div",null,i(e(p).accessibility.withThumbnails)+"/"+i(e(p).totalNewsletters)+" thumbnails",1)])):m("",!0)])]),s("div",ll,[r(k,{flat:"",label:"Clear All Filters",icon:"clear_all",color:"negative",size:"sm",onClick:pe,disable:!e($)},null,8,["disable"]),r(ae),e($)?(o(),c("div",sl,[u.value.year?(o(),y(C,{key:0,removable:"",onRemove:a[13]||(a[13]=n=>{u.value.year=null,x()}),color:"primary","text-color":"white",dense:"",role:"listitem"},{default:d(()=>[v(" Year: "+i(u.value.year),1)]),_:1})):m("",!0),u.value.month?(o(),y(C,{key:1,removable:"",onRemove:a[14]||(a[14]=n=>{u.value.month=null,x()}),color:"secondary","text-color":"white",dense:"",role:"listitem"},{default:d(()=>[v(" Month: "+i(fe.value.find(n=>n.value===u.value.month)?.label),1)]),_:1})):m("",!0),u.value.pageCount?(o(),y(C,{key:2,removable:"",onRemove:a[15]||(a[15]=n=>{u.value.pageCount=null,x()}),color:"info","text-color":"white",dense:"",role:"listitem"},{default:d(()=>[v(i(ye.value.find(n=>n.value===u.value.pageCount)?.label),1)]),_:1})):m("",!0),u.value.featured?(o(),y(C,{key:3,removable:"",onRemove:a[16]||(a[16]=n=>{u.value.featured=!1,x()}),color:"positive","text-color":"white",dense:"",role:"listitem"},{default:d(()=>a[25]||(a[25]=[v(" Featured ",-1)])),_:1,__:[25]})):m("",!0),u.value.hasDescription?(o(),y(C,{key:4,removable:"",onRemove:a[17]||(a[17]=n=>{u.value.hasDescription=null,x()}),color:"purple","text-color":"white",dense:"",role:"listitem"},{default:d(()=>a[26]||(a[26]=[v(" With Descriptions ",-1)])),_:1,__:[26]})):m("",!0),u.value.hasSearchableText?(o(),y(C,{key:5,removable:"",onRemove:a[18]||(a[18]=n=>{u.value.hasSearchableText=null,x()}),color:"orange","text-color":"white",dense:"",role:"listitem"},{default:d(()=>a[27]||(a[27]=[v(" Text Searchable ",-1)])),_:1,__:[27]})):m("",!0),u.value.hasThumbnail?(o(),y(C,{key:6,removable:"",onRemove:a[19]||(a[19]=n=>{u.value.hasThumbnail=null,x()}),color:"teal","text-color":"white",dense:"",role:"listitem"},{default:d(()=>a[28]||(a[28]=[v(" With Thumbnails ",-1)])),_:1,__:[28]})):m("",!0),h.value?(o(),y(C,{key:7,removable:"",onRemove:a[20]||(a[20]=n=>{h.value="",te()}),color:"accent","text-color":"white",dense:"",role:"listitem"},{default:d(()=>[v(' Search: "'+i(h.value)+'" ',1)]),_:1})):m("",!0)])):m("",!0)])],512),[[Ve,O.value]])]),_:1}),s("div",al,[s("div",rl,[r(He,{modelValue:Q.value,"onUpdate:modelValue":a[21]||(a[21]=n=>Q.value=n),options:[{label:"Grid",value:!1,icon:"grid_view",slot:"grid"},{label:"By Year",value:!0,icon:"view_list",slot:"year"}],color:"primary","toggle-color":"secondary",flat:"","aria-label":"Switch view mode, currently "+(Q.value?"year grouped":"grid")+" view"},null,8,["modelValue","aria-label"])]),r(ae),s("div",ol,[s("div",{class:T(["text-body2",E.value])},[r(g,{name:"library_books",class:"q-mr-xs"}),s("span",nl,i(e(D).length),1),v(" of "+i(e(Y).length)+" newsletter"+i(e(D).length===1?"":"s")+" ",1),h.value||e($)?(o(),c("span",il," (filtered) ")):m("",!0),e(q)?.searchStats?.searchTime?(o(),c("span",dl," • "+i(e(q).searchStats.searchTime)+"ms ",1)):m("",!0)],2),e(p)?.accessibility&&e(D).length>0?(o(),c("div",ul,[r(g,{name:"accessibility",size:"12px",class:"q-mr-xs"}),v(" "+i(Math.round(e(p).accessibility.withDescriptions/e(p).totalNewsletters*100))+"% have descriptions, "+i(Math.round(e(p).accessibility.withSearchableText/e(p).totalNewsletters*100))+"% searchable ",1)])):m("",!0)])])]),_:1})]),_:1},8,["class"]),e(de)?(o(),c("div",cl,[r(Ye,{color:"primary",size:"3rem"}),a[29]||(a[29]=s("div",{class:"text-body1 q-ml-md"},"Loading newsletters from Firebase...",-1))])):e(I)?(o(),y(Z,{key:1,flat:"",bordered:"",class:"q-mb-md bg-negative text-white"},{default:d(()=>[r(j,null,{default:d(()=>[s("div",ml,[r(g,{name:"error",class:"q-mr-sm"}),a[30]||(a[30]=v(" Error Loading Newsletters ",-1))]),s("p",vl,i(e(I)),1),r(k,{flat:"",color:"white",label:"Retry",onClick:Re,class:"q-mt-sm"})]),_:1})]),_:1})):e(ee)?Q.value?(o(),c("div",Tl,[(o(!0),c(B,null,G(e(ie),n=>(o(),c("div",{key:n.year,class:"q-mb-xl"},[r(Z,{flat:"",class:T([w.value,"q-mb-md"])},{default:d(()=>[r(j,{class:"q-py-md"},{default:d(()=>[s("div",kl,[s("div",Nl,i(n.year),1),r(ae),s("div",{class:T(["text-body2",E.value])},i(n.newsletters.length)+" issue"+i(n.newsletters.length===1?"":"s"),3)])]),_:2},1024)]),_:2},1032,["class"]),s("div",El,[s("div",Cl,[(o(!0),c(B,null,G(n.newsletters,X=>(o(),c("div",{key:X.id,class:"col-12 col-sm-6 col-md-4 col-lg-3 col-xl-3 q-pa-md"},[r(Ee,{newsletter:X,"show-admin-controls":H.value,onMetadataUpdated:xe,onRefreshNeeded:Te},null,8,["newsletter","show-admin-controls"])]))),128))])])]))),128))])):(o(),c("div",Sl,[s("div",xl,[(o(!0),c(B,null,G(e(S),n=>(o(),c("div",{key:n.id,class:"col-12 col-sm-6 col-md-4 col-lg-3 col-xl-3 q-pa-md"},[r(Ee,{newsletter:n,"show-admin-controls":H.value,onMetadataUpdated:xe,onRefreshNeeded:Te},null,8,["newsletter","show-admin-controls"])]))),128))])])):(o(),c("div",bl,[r(g,{name:"search_off",size:"4rem",class:T(E.value)},null,8,["class"]),s("div",{class:T(["text-h6 q-mt-md",E.value])}," No newsletters found ",2),s("div",{class:T(["text-body1 q-mt-sm",E.value])},[h.value?(o(),c("span",pl,[a[31]||(a[31]=v(' No results for "',-1)),s("strong",null,i(h.value),1),a[32]||(a[32]=v('" ',-1))])):e($)?(o(),c("span",wl," No newsletters match your current filters ")):(o(),c("span",hl," No newsletters are currently available "))],2),h.value||e($)?(o(),c("div",fl,[a[33]||(a[33]=s("div",{class:"text-body2 q-mb-sm"},"Try:",-1)),s("div",yl,[h.value?(o(),y(k,{key:0,outline:"",size:"sm",color:"primary",onClick:a[22]||(a[22]=n=>{h.value="",te()}),label:"Clear Search"})):m("",!0),e($)?(o(),y(k,{key:1,outline:"",size:"sm",color:"secondary",onClick:pe,label:"Clear Filters"})):m("",!0),r(k,{outline:"",size:"sm",color:"accent",onClick:a[23]||(a[23]=n=>le("featured")),label:"View Featured"})])])):m("",!0),!h.value&&!e($)&&e(p)?.availableTags.length?(o(),c("div",gl,[a[34]||(a[34]=s("div",{class:"text-body2 q-mb-sm"},"Popular topics:",-1)),s("div",_l,[(o(!0),c(B,null,G(e(p).availableTags.slice(0,6),n=>(o(),y(C,{key:n,clickable:"",size:"sm",color:"grey-3","text-color":"dark",class:"q-mr-xs q-mb-xs",onClick:X=>{h.value=n,te()}},{default:d(()=>[v(i(n),1)]),_:2},1032,["onClick"]))),128))])])):m("",!0)]))])])])]),_:1}))}}),ss=Fe(ql,[["__scopeId","data-v-eaa9fbe4"]]);export{ss as default};
