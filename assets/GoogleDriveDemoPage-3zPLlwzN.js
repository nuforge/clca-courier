import{r as b,b0 as re,c as P,k as se,al as ie,am as ae,h as ne,d as Z,o as J,a4 as T,f as i,a6 as E,M as d,a7 as A,a5 as o,P as S,a2 as w,N as G,aa as I,R as _,Q as le,b1 as ce,a3 as D,F as B,a9 as X,ae as ue,I as ee,$ as K,aj as M,J as x}from"./index-exu2_NhE.js";import{Q as R}from"./QBanner-Bcv1Uyxm.js";import{Q as de}from"./QPage-Bb9ZLHd0.js";import{u as me}from"./useExternalImage-Bet6PjBc.js";import{Q as j}from"./QSpace-CkEAJx2l.js";import{Q as ge}from"./QSelect-Bwtx7ExT.js";import{Q as ve}from"./QSpinnerDots-bj-uQrgp.js";import{Q as W}from"./QImg-Do32aQwA.js";import{C as H}from"./ClosePopup-e7WF7z_C.js";import{u as fe}from"./use-quasar-DJa0Nk5u.js";import"./QChip-Hc59Q2x4.js";import"./QItem-BjTdXJgq.js";import"./QMenu-WX38jfoz.js";import"./position-engine-Do5F7S8K.js";import"./selection-Bh_hi2SL.js";import"./format-BvkBI9bc.js";class he{clientId;apiKey;scope;accessToken="";isAuthenticated=!1;constructor(e,s){this.clientId=e,this.apiKey=s,this.scope="https://www.googleapis.com/auth/drive.readonly https://www.googleapis.com/auth/drive.metadata.readonly"}async loadGoogleIdentityServices(){return new Promise((e,s)=>{if(window.google?.accounts){e();return}const a=document.createElement("script");a.src="https://accounts.google.com/gsi/client",a.async=!0,a.defer=!0,a.onload=()=>e(),a.onerror=()=>s(new Error("Failed to load Google Identity Services")),document.head.appendChild(a)})}async authenticate(){try{return await this.loadGoogleIdentityServices(),new Promise((e,s)=>{try{console.log("Initializing token client...");const a=window.google.accounts.oauth2.initTokenClient({client_id:this.clientId,scope:this.scope,callback:n=>{if(console.log("OAuth callback received:",n),n.error){console.error("OAuth2 error:",n),this.isAuthenticated=!1,n.error==="popup_blocked_by_browser"?s(new Error("Popup blocked by browser. Please allow popups for this site and try again.")):n.error==="popup_closed_by_user"?s(new Error("Authentication cancelled by user.")):s(new Error(`OAuth2 error: ${n.error}`));return}n.access_token?(this.accessToken=n.access_token,this.isAuthenticated=!0,console.log("Authentication successful! Token received."),e(!0)):(console.error("No access token received in response"),this.isAuthenticated=!1,s(new Error("Authentication failed: No access token received")))},error_callback:n=>{console.error("OAuth2 error callback:",n),this.isAuthenticated=!1,n.type==="popup_failed_to_open"?s(new Error("POPUP_BLOCKED: Browser blocked the authentication popup. Please allow popups for this site and try again.")):n.type==="popup_closed"?s(new Error("POPUP_CLOSED: Authentication popup was closed. Please complete the authentication process and try again.")):n.type==="access_denied"?s(new Error("ACCESS_DENIED: Permission was denied. Please grant access to Google Drive to continue.")):n.type==="popup_blocked_by_browser"?s(new Error("POPUP_BLOCKED: Browser security settings are blocking popups. Please check your browser settings.")):s(new Error(`Authentication error (${n.type}): ${n.details||"Please check your browser settings and try again"}`))}});console.log("Requesting access token...");const g=setTimeout(()=>{console.warn("Authentication timeout - popup may be blocked"),s(new Error("Authentication timeout. The popup may be blocked by your browser. Please check your popup settings."))},3e4);try{const n=a;if(n.callback){const v=n.callback;n.callback=k=>{clearTimeout(g),v(k)}}a.requestAccessToken({prompt:"consent"})}catch(n){clearTimeout(g),console.error("Failed to request access token:",n),s(new Error("Failed to open authentication popup. Please check your browser settings and allow popups."))}}catch(a){console.error("Token client initialization failed:",a),this.isAuthenticated=!1,s(a instanceof Error?a:new Error(String(a)))}})}catch(e){return console.error("Authentication failed:",e),this.isAuthenticated=!1,!1}}async testApiCall(){if(!this.isAuthenticated||!this.accessToken)throw new Error("Not authenticated");try{const e=await fetch(`https://www.googleapis.com/drive/v3/files?pageSize=10&key=${this.apiKey}`,{headers:{Authorization:`Bearer ${this.accessToken}`}});if(!e.ok)throw new Error(`API call failed: ${e.status} ${e.statusText}`);const s=await e.json();return console.log("API call successful:",s),s}catch(e){throw console.error("API call failed:",e),e}}getStatus(){return{isAuthenticated:this.isAuthenticated,hasToken:this.accessToken!=="",accessToken:this.accessToken?`${this.accessToken.substring(0,10)}...`:"none"}}async checkTokenValidity(){if(!this.accessToken)return this.isAuthenticated=!1,!1;try{return(await fetch(`https://www.googleapis.com/drive/v3/about?fields=user&key=${this.apiKey}`,{headers:{Authorization:`Bearer ${this.accessToken}`}})).ok?(this.isAuthenticated=!0,console.log("Token is still valid"),!0):(console.log("Token is invalid or expired"),this.isAuthenticated=!1,this.accessToken="",!1)}catch(e){return console.error("Token validation failed:",e),this.isAuthenticated=!1,this.accessToken="",!1}}signOut(){this.accessToken="",this.isAuthenticated=!1,console.log("Signed out successfully")}}class O extends he{baseUrl="https://www.googleapis.com/drive/v3";constructor(e,s){super(e,s)}async makeApiRequest(e,s={}){if(!this.isAuthenticated||!this.accessToken)throw new Error("Not authenticated with Google Drive");const a=new URL(`${this.baseUrl}${e}`);a.searchParams.set("key",this.apiKey),Object.entries(s).forEach(([n,v])=>{a.searchParams.set(n,v)});const g=await fetch(a.toString(),{headers:{Authorization:`Bearer ${this.accessToken}`,"Content-Type":"application/json"}});if(!g.ok){const n=await g.json().catch(()=>({}));throw new Error(`Google Drive API error: ${g.status} ${g.statusText}. ${n.error?.message||"Unknown error"}`)}return g}async getFile(e){try{const a=await(await this.makeApiRequest(`/files/${e}`,{fields:"id,name,mimeType,size,webViewLink,webContentLink,thumbnailLink,parents,createdTime,modifiedTime"})).json();return this.convertToGoogleDriveFile(a)}catch(s){throw console.error("Error getting file:",s),new Error(`Failed to get file: ${s instanceof Error?s.message:"Unknown error"}`)}}async listFilesInFolder(e,s=100){try{return((await(await this.makeApiRequest("/files",{q:`'${e}' in parents and trashed=false`,pageSize:s.toString(),fields:"files(id,name,mimeType,size,webViewLink,webContentLink,thumbnailLink,parents,createdTime,modifiedTime)",orderBy:"modifiedTime desc"})).json()).files||[]).map(n=>this.convertToGoogleDriveFile(n))}catch(a){throw console.error("Error listing folder files:",a),new Error(`Failed to list folder files: ${a instanceof Error?a.message:"Unknown error"}`)}}async searchFiles(e,s=50){try{return((await(await this.makeApiRequest("/files",{q:`name contains '${e}' and trashed=false`,pageSize:s.toString(),fields:"files(id,name,mimeType,size,webViewLink,webContentLink,thumbnailLink,parents,createdTime,modifiedTime)",orderBy:"modifiedTime desc"})).json()).files||[]).map(n=>this.convertToGoogleDriveFile(n))}catch(a){throw console.error("Error searching files:",a),new Error(`Failed to search files: ${a instanceof Error?a.message:"Unknown error"}`)}}async searchImages(e=[],s=""){try{let a="mimeType contains 'image/' and trashed=false";if(e.length>0){const v=e.map(k=>`'${k}' in parents`).join(" or ");a+=` and (${v})`}return s.trim()&&(a+=` and name contains '${s.trim()}'`),((await(await this.makeApiRequest("/files",{q:a,pageSize:"100",fields:"files(id,name,mimeType,size,webViewLink,webContentLink,thumbnailLink,parents,createdTime,modifiedTime)",orderBy:"modifiedTime desc"})).json()).files||[]).map(v=>this.convertToGoogleDriveFile(v))}catch(a){throw console.error("Error searching images:",a),new Error(`Failed to search images: ${a instanceof Error?a.message:"Unknown error"}`)}}async downloadFile(e){try{return await(await this.makeApiRequest(`/files/${e}`,{alt:"media"})).blob()}catch(s){throw console.error("Error downloading file:",s),new Error(`Failed to download file: ${s instanceof Error?s.message:"Unknown error"}`)}}getImageUrl(e){return e.thumbnailLink?e.thumbnailLink:e.webContentLink?e.webContentLink:`https://drive.google.com/uc?id=${e.id}&export=download`}convertToGoogleDriveFile(e){return{id:e.id,name:e.name,mimeType:e.mimeType,size:e.size,webViewLink:e.webViewLink,webContentLink:e.webContentLink,thumbnailLink:e.thumbnailLink,parents:e.parents||[],createdTime:e.createdTime,modifiedTime:e.modifiedTime}}static isGoogleDriveUrl(e){return e.includes("drive.google.com")||e.includes("docs.google.com")}static extractFileId(e){const s=[/\/file\/d\/([a-zA-Z0-9-_]+)/,/id=([a-zA-Z0-9-_]+)/,/\/d\/([a-zA-Z0-9-_]+)/];for(const a of s){const g=e.match(a);if(g&&g[1])return g[1]}return null}}function te(){const r=b({isAuthenticated:!1,isLoading:!1,error:null,files:[],searchResults:[]});let e=null;const s=c=>{try{if(!c.apiKey||!c.clientId)throw new Error("API key and Client ID are required");e=new O(c.clientId,c.apiKey),r.value.error=null,console.log("Google Drive service initialized")}catch(t){const l=t instanceof Error?t.message:"Failed to initialize Google Drive service";r.value.error=l,console.error("Google Drive initialization error:",t)}},a=async()=>{if(!e)return r.value.error="Google Drive service not initialized",!1;r.value.isLoading=!0,r.value.error=null;try{const c=await e.authenticate();return r.value.isAuthenticated=c,c&&console.log("Google Drive authentication successful"),c}catch(c){const t=c instanceof Error?c.message:"Authentication failed";return r.value.error=t,r.value.isAuthenticated=!1,console.error("Google Drive authentication error:",c),!1}finally{r.value.isLoading=!1}},g=()=>new Promise((c,t)=>{try{e&&e.signOut(),r.value.isAuthenticated=!1,r.value.files=[],r.value.searchResults=[],c()}catch(l){const p=l instanceof Error?l.message:"Sign out failed";r.value.error=p,t(new Error(p))}}),n=async(c,t)=>{if(!e)return r.value.error="Google Drive service not initialized",[];if(!r.value.isAuthenticated)return r.value.error="Not authenticated with Google Drive",[];r.value.isLoading=!0,r.value.error=null;try{const l=await e.searchImages(t,c);return r.value.searchResults=l,l}catch(l){const p=l instanceof Error?l.message:"Failed to search images";return r.value.error=p,console.error("Google Drive search error:",l),[]}finally{r.value.isLoading=!1}},v=async c=>{if(!e)return r.value.error="Google Drive service not initialized",[];if(!r.value.isAuthenticated)return r.value.error="Not authenticated with Google Drive",[];r.value.isLoading=!0,r.value.error=null;try{const t=await e.listFilesInFolder(c);return r.value.files=t,t}catch(t){const l=t instanceof Error?t.message:"Failed to list folder files";return r.value.error=l,console.error("Google Drive folder listing error:",t),[]}finally{r.value.isLoading=!1}},k=async c=>{if(!e)return r.value.error="Google Drive service not initialized",null;if(!r.value.isAuthenticated)return r.value.error="Not authenticated with Google Drive",null;r.value.isLoading=!0,r.value.error=null;try{return await e.downloadFile(c)}catch(t){const l=t instanceof Error?t.message:"Download failed";return r.value.error=l,console.error("Google Drive download error:",t),null}finally{r.value.isLoading=!1}},y=async c=>{if(!e)return r.value.error="Google Drive service not initialized",null;if(!r.value.isAuthenticated)return r.value.error="Not authenticated with Google Drive",null;r.value.isLoading=!0,r.value.error=null;try{return await e.getFile(c)}catch(t){const l=t instanceof Error?t.message:"Failed to get file";return r.value.error=l,console.error("Google Drive get file error:",t),null}finally{r.value.isLoading=!1}},F=async c=>{if(!e)return r.value.error="Google Drive service not initialized",[];if(!r.value.isAuthenticated)return r.value.error="Not authenticated with Google Drive",[];r.value.isLoading=!0,r.value.error=null;try{const t=await e.searchFiles(c);return r.value.searchResults=t,t}catch(t){const l=t instanceof Error?t.message:"Failed to search files";return r.value.error=l,console.error("Google Drive search files error:",t),[]}finally{r.value.isLoading=!1}},L=async c=>{if(!e)return{thumbnail:"",direct:"",authenticated:""};try{const t=await e.getFile(c);return{thumbnail:t.thumbnailLink||"",direct:t.webContentLink||`https://drive.google.com/uc?id=${c}&export=download`,authenticated:e.getImageUrl(t)}}catch(t){return console.error("Failed to get file URLs:",t),{thumbnail:"",direct:"",authenticated:""}}},C=c=>O.extractFileId(c),h=c=>O.isGoogleDriveUrl(c);return{state:re(r),isAuthenticated:()=>r.value.isAuthenticated,isLoading:()=>r.value.isLoading,error:()=>r.value.error,files:()=>r.value.files,searchResults:()=>r.value.searchResults,initialize:s,authenticate:a,signOut:g,getFile:y,searchFiles:F,searchImages:n,listFilesInFolder:v,downloadFile:k,getUrls:L,extractFileIdFromUrl:C,isGoogleDriveUrl:h}}function pe(){const r=te(),e=b(!1),s=b({}),a=h=>{s.value={...h},h.enableGoogleDrive&&h.googleDriveConfig&&(r.initialize(h.googleDriveConfig),e.value=!0)},g=async(h,c={})=>{const t={...s.value,...c};try{const l={lazy:!1,...t.maxWidth&&{maxWidth:t.maxWidth},...t.maxHeight&&{maxHeight:t.maxHeight},...t.quality&&{quality:t.quality}},p=me(h,l);if(await p.load(),!p.hasError.value&&p.imageUrl.value)return{success:!0,url:p.imageUrl.value,message:"Image loaded successfully",source:"direct"};if(t.enableGoogleDrive&&e.value){if(console.log("Direct image loading failed, trying Google Drive fallback..."),!r.isAuthenticated())return{success:!1,url:null,message:"Direct image loading failed and Google Drive authentication required",source:"error"};const N=F(h)||t.searchQuery||"image",U=await r.searchImages(N,t.folderIds);if(U.length>0){const q=U[0];if(q)try{const z=await r.getUrls(q.id);return{success:!0,url:z.authenticated||z.direct,message:`Found fallback image: ${q.name}`,source:"google-drive",metadata:{filename:q.name,...q.size&&{size:q.size},mimeType:q.mimeType}}}catch(z){console.error("Error getting Google Drive image URL:",z)}}return{success:!1,url:null,message:"Image not found in Google Drive",source:"error"}}return{success:!1,url:null,message:p.error.value?.message||"Image loading failed",source:"error"}}catch(l){return console.error("Error in loadImage:",l),{success:!1,url:null,message:l instanceof Error?l.message:"Unknown error occurred",source:"error"}}},n=async(h,c={})=>{const t=h.map(l=>g(l,c));return Promise.all(t)},v=async h=>{if(!e.value||!r.isAuthenticated())throw new Error("Google Drive not initialized or not authenticated");try{const c=await r.searchImages(void 0,[h]);return await Promise.all(c.map(async l=>{try{const p=await r.getUrls(l.id);return{success:!0,url:p.authenticated||p.direct,message:`Preloaded: ${l.name}`,source:"google-drive",metadata:{filename:l.name,...l.size&&{size:l.size},mimeType:l.mimeType}}}catch(p){return console.error(`Failed to get URLs for image ${l.name}:`,p),{success:!1,url:null,message:`Failed to load: ${l.name}`,source:"google-drive"}}}))}catch(c){throw console.error("Error preloading Google Drive folder:",c),c}},k=async()=>{if(!e.value)throw new Error("Service not initialized");return r.authenticate()},y=async()=>{if(!e.value)throw new Error("Service not initialized");return r.signOut()},F=h=>{try{const l=new URL(h).pathname.split("/").pop();return l&&l.includes(".")&&l.split(".")[0]?.replace(/[-_]/g," ")||null}catch{return null}},L=P(()=>e.value&&r.isAuthenticated()),C=P(()=>({initialized:e.value,authenticated:r.isAuthenticated(),loading:r.isLoading(),error:r.error()}));return{initialize:a,loadImage:g,loadImages:n,preloadGoogleDriveFolder:v,authenticateGoogleDrive:k,signOutGoogleDrive:y,isGoogleDriveReady:L,googleDriveStatus:C,googleDrive:r}}const ye='<rect x="0" y="0" width="100" height="100" fill="none"></rect><g transform="translate(25 25)"><rect x="-20" y="-20" width="40" height="40" fill="currentColor" opacity="0.9"><animateTransform attributeName="transform" type="scale" from="1.5" to="1" repeatCount="indefinite" begin="0s" dur="1s" calcMode="spline" keySplines="0.2 0.8 0.2 0.8" keyTimes="0;1"></animateTransform></rect></g><g transform="translate(75 25)"><rect x="-20" y="-20" width="40" height="40" fill="currentColor" opacity="0.8"><animateTransform attributeName="transform" type="scale" from="1.5" to="1" repeatCount="indefinite" begin="0.1s" dur="1s" calcMode="spline" keySplines="0.2 0.8 0.2 0.8" keyTimes="0;1"></animateTransform></rect></g><g transform="translate(25 75)"><rect x="-20" y="-20" width="40" height="40" fill="currentColor" opacity="0.7"><animateTransform attributeName="transform" type="scale" from="1.5" to="1" repeatCount="indefinite" begin="0.3s" dur="1s" calcMode="spline" keySplines="0.2 0.8 0.2 0.8" keyTimes="0;1"></animateTransform></rect></g><g transform="translate(75 75)"><rect x="-20" y="-20" width="40" height="40" fill="currentColor" opacity="0.6"><animateTransform attributeName="transform" type="scale" from="1.5" to="1" repeatCount="indefinite" begin="0.2s" dur="1s" calcMode="spline" keySplines="0.2 0.8 0.2 0.8" keyTimes="0;1"></animateTransform></rect></g>',Y=se({name:"QSpinnerCube",props:ie,setup(r){const{cSize:e,classes:s}=ae(r);return()=>ne("svg",{class:s.value,width:e.value,height:e.value,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid",innerHTML:ye})}}),we={class:"text-h6 q-mb-md"},be={key:0,class:"q-mb-md"},ke={key:1,class:"q-mb-md"},_e={class:"row items-center q-mb-md"},De={class:"row q-gutter-md q-mb-md"},xe={class:"col-12 col-md-6"},Ce={class:"col-12 col-md-4"},Te={class:"row q-gutter-sm q-mb-md"},Ge={key:2,class:"q-mb-md"},Ie={key:3,class:"text-center q-py-md"},Ae={key:4,class:"q-mb-md"},qe={class:"text-subtitle1 q-mb-sm"},Ee={class:"row q-gutter-md"},$e={class:"absolute-full flex flex-center"},Le={class:"absolute-full flex flex-center bg-grey-3"},Fe=["title"],ze={class:"text-caption text-grey-6"},Se={key:5,class:"text-center q-py-lg"},Pe={class:"text-h6"},Ue={class:"absolute-full flex flex-center"},Re=Z({__name:"GoogleDriveImageBrowser",setup(r){const e=fe(),s=te(),a=b(""),g=b([]),n=b([]),v=b(!1),k=b(!1),y=b(null),F=b([{label:"Content Folder",value:void 0},{label:"Images Folder",value:void 0},{label:"Issues Folder",value:void 0},{label:"Templates Folder",value:void 0}].filter(m=>m.value&&m.value!=="Not configured")),L=s.isAuthenticated,C=s.isLoading,h=s.error;J(()=>{console.warn("Google Drive API credentials not configured")});const c=async()=>{try{await s.authenticate()&&e.notify({type:"positive",message:"Successfully connected to Google Drive",position:"top"})}catch(m){console.error("Failed to connect to Google Drive:",m),e.notify({type:"negative",message:"Failed to connect to Google Drive",position:"top"})}},t=async()=>{try{await s.signOut(),n.value=[],v.value=!1,e.notify({type:"info",message:"Disconnected from Google Drive",position:"top"})}catch(m){console.error("Failed to sign out:",m),e.notify({type:"negative",message:"Failed to sign out",position:"top"})}},l=async()=>{if(!a.value.trim()){e.notify({type:"warning",message:"Please enter search terms",position:"top"});return}try{const m=await s.searchImages(a.value,g.value.length>0?g.value:void 0);n.value=m,v.value=!0,m.length===0&&e.notify({type:"info",message:"No images found matching your search",position:"top"})}catch(m){console.error("Search failed:",m),e.notify({type:"negative",message:"Search failed",position:"top"})}},p=async()=>{try{const m=await s.searchImages(void 0,g.value.length>0?g.value:void 0);n.value=m,v.value=!0,m.length===0&&e.notify({type:"info",message:"No images found in selected folders",position:"top"})}catch(m){console.error("Failed to browse images:",m),e.notify({type:"negative",message:"Failed to browse images",position:"top"})}},N=()=>{n.value=[],v.value=!1,a.value=""},U=m=>m.thumbnailLink||`https://drive.google.com/uc?id=${m.id}&export=download`,q=m=>m.webContentLink||m.thumbnailLink||`https://drive.google.com/uc?id=${m.id}&export=download`,z=m=>{y.value=m,k.value=!0},Q=async m=>{try{const u=await s.downloadFile(m.id);if(u){const f=URL.createObjectURL(u),$=document.createElement("a");$.href=f,$.download=m.name,document.body.appendChild($),$.click(),document.body.removeChild($),URL.revokeObjectURL(f),e.notify({type:"positive",message:"Image downloaded successfully",position:"top"})}}catch(u){console.error("Failed to download image:",u),e.notify({type:"negative",message:"Failed to download image",position:"top"})}},V=async m=>{try{const u=q(m);await navigator.clipboard.writeText(u),e.notify({type:"positive",message:"Image URL copied to clipboard",position:"top"})}catch(u){console.error("Failed to copy URL:",u),e.notify({type:"negative",message:"Failed to copy URL",position:"top"})}},oe=m=>{if(!m)return"Unknown size";const u=parseInt(m);return u<1024?`${u} B`:u<1024*1024?`${(u/1024).toFixed(1)} KB`:u<1024*1024*1024?`${(u/(1024*1024)).toFixed(1)} MB`:`${(u/(1024*1024*1024)).toFixed(1)} GB`};return(m,u)=>(x(),T(B,null,[i(E,null,{default:d(()=>[i(A,null,{default:d(()=>[o("div",we,[i(G,{name:"mdi-google-drive",class:"q-mr-sm"}),u[5]||(u[5]=w(" Google Drive Image Browser ",-1))]),I(L)()?(x(),T("div",ke,[o("div",_e,[i(G,{name:"mdi-check-circle",color:"green",class:"q-mr-sm"}),u[7]||(u[7]=o("span",{class:"text-body1"},"Connected to Google Drive",-1)),i(j),i(_,{color:"grey-8",outline:"",size:"sm",label:"Sign Out",onClick:t})]),o("div",De,[o("div",xe,[i(le,{modelValue:a.value,"onUpdate:modelValue":u[0]||(u[0]=f=>a.value=f),label:"Search images",placeholder:"Enter search terms...",clearable:"",onKeyup:ce(l,["enter"])},{append:d(()=>[i(_,{icon:"search",flat:"",onClick:l,loading:I(C)()},null,8,["loading"])]),_:1},8,["modelValue"])]),o("div",Ce,[i(ge,{modelValue:g.value,"onUpdate:modelValue":u[1]||(u[1]=f=>g.value=f),options:F.value,label:"Search in folders",multiple:"",clearable:"","emit-value":"","map-options":""},null,8,["modelValue","options"])])]),o("div",Te,[i(_,{color:"primary",label:"Search Images",onClick:l,loading:I(C)(),disable:!a.value},null,8,["loading","disable"]),i(_,{color:"secondary",outline:"",label:"Browse All Images",onClick:p,loading:I(C)()},null,8,["loading"]),i(_,{color:"grey-8",outline:"",label:"Clear Results",onClick:N,disable:n.value.length===0},null,8,["disable"])])])):(x(),T("div",be,[i(R,{class:"bg-blue-1 text-blue-8",rounded:""},{avatar:d(()=>[i(G,{name:"mdi-information",color:"blue"})]),action:d(()=>[i(_,{color:"primary",label:"Connect to Google Drive",onClick:c,loading:I(C)()},null,8,["loading"])]),default:d(()=>[u[6]||(u[6]=o("div",{class:"text-body2"}," Connect to Google Drive to browse and search your images. ",-1))]),_:1,__:[6]})])),I(h)()?(x(),T("div",Ge,[i(R,{class:"bg-red-1 text-red-8",rounded:""},{avatar:d(()=>[i(G,{name:"mdi-alert",color:"red"})]),default:d(()=>[w(" "+D(I(h)()),1)]),_:1})])):S("",!0),I(C)()?(x(),T("div",Ie,[i(ve,{size:"50px",color:"primary"}),u[8]||(u[8]=o("div",{class:"text-body2 q-mt-sm"},"Loading images from Google Drive...",-1))])):S("",!0),!I(C)()&&n.value.length>0?(x(),T("div",Ae,[o("div",qe," Found "+D(n.value.length)+" image(s) ",1),o("div",Ee,[(x(!0),T(B,null,X(n.value,f=>(x(),T("div",{key:f.id,class:"col-12 col-sm-6 col-md-4 col-lg-3"},[i(E,{flat:"",bordered:""},{default:d(()=>[i(W,{src:U(f),alt:f.name,ratio:"1",class:"cursor-pointer",onClick:$=>z(f)},{loading:d(()=>[o("div",$e,[i(Y,{size:"50px",color:"primary"})])]),error:d(()=>[o("div",Le,[i(G,{name:"mdi-image-broken",size:"50px",color:"grey-6"})])]),_:2},1032,["src","alt","onClick"]),i(A,{class:"q-pa-sm"},{default:d(()=>[o("div",{class:"text-caption text-weight-medium ellipsis",title:f.name},D(f.name),9,Fe),o("div",ze,D(oe(f.size)),1)]),_:2},1024),i(M,{align:"right",class:"q-pa-sm"},{default:d(()=>[i(_,{size:"sm",flat:"",icon:"mdi-eye",onClick:$=>z(f)},null,8,["onClick"]),i(_,{size:"sm",flat:"",icon:"mdi-download",onClick:$=>Q(f)},null,8,["onClick"]),i(_,{size:"sm",flat:"",icon:"mdi-link",onClick:$=>V(f)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]))),128))])])):S("",!0),!I(C)()&&I(L)()&&n.value.length===0&&v.value?(x(),T("div",Se,[i(G,{name:"mdi-image-off",size:"64px",color:"grey-5"}),u[9]||(u[9]=o("div",{class:"text-body1 text-grey-6 q-mt-md"},"No images found",-1)),u[10]||(u[10]=o("div",{class:"text-body2 text-grey-5"},"Try adjusting your search terms or browse all images",-1))])):S("",!0)]),_:1})]),_:1}),i(ue,{modelValue:k.value,"onUpdate:modelValue":u[4]||(u[4]=f=>k.value=f),maximized:""},{default:d(()=>[y.value?(x(),ee(E,{key:0},{default:d(()=>[i(A,{class:"row items-center q-pb-none"},{default:d(()=>[o("div",Pe,D(y.value.name),1),i(j),K(i(_,{icon:"close",flat:"",round:"",dense:""},null,512),[[H]])]),_:1}),i(A,{class:"q-pt-none"},{default:d(()=>[i(W,{src:q(y.value),alt:y.value.name,fit:"contain",style:{"max-height":"80vh"}},{loading:d(()=>[o("div",Ue,[i(Y,{size:"50px",color:"primary"})])]),_:1},8,["src","alt"])]),_:1}),i(M,{align:"right"},{default:d(()=>[i(_,{flat:"",label:"Download",icon:"mdi-download",onClick:u[2]||(u[2]=f=>Q(y.value))}),i(_,{flat:"",label:"Copy URL",icon:"mdi-link",onClick:u[3]||(u[3]=f=>V(y.value))}),K(i(_,{flat:"",label:"Close"},null,512),[[H]])]),_:1})]),_:1})):S("",!0)]),_:1},8,["modelValue"])],64))}}),Ne={class:"row q-gutter-lg"},Oe={class:"col-12 col-md-6"},Be={class:"q-mt-md"},Qe={class:"row items-center q-mb-sm"},Ve={class:"row items-center q-mb-sm"},Ke={class:"row items-center q-mb-sm"},Me={class:"row items-center q-mb-sm"},je={key:0,class:"q-mt-md"},We={class:"q-mt-md"},He={class:"col-12 col-md-6"},Ye={class:"q-mt-md"},Ze={class:"text-body2 q-mb-sm"},Je={class:"text-body2 q-mb-sm"},Xe={class:"text-body2 q-mb-sm"},et={class:"text-body2 q-mb-sm"},tt={class:"q-mt-lg"},ot={class:"row q-gutter-md"},rt={class:"row items-center q-mb-sm"},st={class:"text-weight-medium"},it={class:"text-caption text-grey-7"},at={key:0,class:"text-body2 q-mt-sm"},nt={class:"q-mt-lg"},lt={class:"q-gutter-sm"},ct={class:"q-mt-lg"},ut={class:"q-mt-lg"},dt={class:"q-mt-md"},mt={class:"q-mt-lg"},At=Z({__name:"GoogleDriveDemoPage",setup(r){const e=pe(),s=b(!1),a=b(!1),g=b(!1),n=b(""),v=b(""),k=b(""),y=b({content:{name:"Content",id:"",description:"Main content folder"},issues:{name:"Issues",id:"",description:"Newsletter issues"},pdfs:{name:"PDFs",id:"",description:"PDF documents"},images:{name:"Images",id:"",description:"Image assets"},templates:{name:"Templates",id:"",description:"Document templates"}}),F=P(()=>n.value?n.value.substring(0,8)+"..."+n.value.substring(n.value.length-4):"Not configured"),L=P(()=>v.value?v.value.substring(0,12)+"..."+v.value.substring(v.value.length-20):"Not configured"),C=P(()=>window.location.origin);J(()=>{n.value="",v.value="",k.value="",s.value=!!(n.value&&n.value!=="your_api_key_here"),a.value=!!(v.value&&v.value!=="your_client_id_here.apps.googleusercontent.com"),g.value=!!(k.value&&k.value!=="your_project_id_here"),y.value.content.id="Not configured",y.value.issues.id="Not configured",y.value.pdfs.id="Not configured",y.value.images.id="Not configured",y.value.templates.id="Not configured",s.value&&a.value&&e.initialize({enableGoogleDrive:!0,googleDriveConfig:{apiKey:n.value,clientId:v.value}})});const h=()=>{window.open("/GOOGLE_DRIVE_INTEGRATION.md","_blank")};return(c,t)=>(x(),ee(de,{class:"q-pa-md"},{default:d(()=>[t[19]||(t[19]=o("div",{class:"q-mb-lg"},[o("h1",{class:"text-h3 q-mb-sm"},"Google Drive Integration Demo"),o("p",{class:"text-subtitle1 text-grey-7"}," This page demonstrates the Google Drive integration setup and configuration status. ")],-1)),o("div",Ne,[o("div",Oe,[i(E,null,{default:d(()=>[i(A,null,{default:d(()=>[t[6]||(t[6]=o("div",{class:"text-h6"},"Configuration Status",-1)),o("div",Be,[o("div",Qe,[i(G,{name:s.value?"mdi-check-circle":"mdi-alert-circle",color:s.value?"green":"orange",class:"q-mr-sm"},null,8,["name","color"]),o("span",null,"Google API Key: "+D(s.value?"Configured":"Missing"),1)]),o("div",Ve,[i(G,{name:a.value?"mdi-check-circle":"mdi-alert-circle",color:a.value?"green":"orange",class:"q-mr-sm"},null,8,["name","color"]),o("span",null,"Client ID: "+D(a.value?"Configured":"Missing"),1)]),o("div",Ke,[i(G,{name:g.value?"mdi-check-circle":"mdi-alert-circle",color:g.value?"green":"orange",class:"q-mr-sm"},null,8,["name","color"]),o("span",null,"Project ID: "+D(g.value?"Configured":"Missing"),1)]),o("div",Me,[i(G,{name:"mdi-check-circle",color:"green",class:"q-mr-sm"}),t[1]||(t[1]=o("span",null,"Implementation: ✅ RESTORED",-1))]),!s.value||!a.value?(x(),T("div",je,[i(R,{class:"bg-orange-1 text-orange-8",rounded:""},{avatar:d(()=>[i(G,{name:"mdi-information",color:"orange"})]),default:d(()=>[t[2]||(t[2]=w(" Configure your Google Drive credentials in the ",-1)),t[3]||(t[3]=o("code",null,".env",-1)),t[4]||(t[4]=w(" file to enable full functionality. ",-1))]),_:1,__:[2,3,4]})])):S("",!0),o("div",We,[i(R,{class:"bg-green-1 text-green-8",rounded:""},{avatar:d(()=>[i(G,{name:"mdi-check-circle",color:"green"})]),default:d(()=>[t[5]||(t[5]=w(" Google Drive integration is now FULLY OPERATIONAL! All core composables and components have been restored and are ready for use. ",-1))]),_:1,__:[5]})])])]),_:1,__:[6]})]),_:1})]),o("div",He,[i(E,null,{default:d(()=>[i(A,null,{default:d(()=>[t[11]||(t[11]=o("div",{class:"text-h6"},"Environment Details",-1)),o("div",Ye,[o("div",Ze,[t[7]||(t[7]=o("strong",null,"API Key:",-1)),w(" "+D(F.value),1)]),o("div",Je,[t[8]||(t[8]=o("strong",null,"Client ID:",-1)),w(" "+D(L.value),1)]),o("div",Xe,[t[9]||(t[9]=o("strong",null,"Project ID:",-1)),w(" "+D(k.value||"Not set"),1)]),o("div",et,[t[10]||(t[10]=o("strong",null,"Development Server:",-1)),w(" "+D(C.value),1)])])]),_:1,__:[11]})]),_:1})])]),o("div",tt,[i(E,null,{default:d(()=>[i(A,null,{default:d(()=>[t[12]||(t[12]=o("div",{class:"text-h6"},"Google Drive Folder Configuration",-1)),t[13]||(t[13]=o("div",{class:"text-subtitle2 text-grey-7 q-mb-md"}," Configured Google Drive folders for content management ",-1)),o("div",ot,[(x(!0),T(B,null,X(y.value,(l,p)=>(x(),T("div",{key:p,class:"col-12 col-md-6"},[i(E,{flat:"",bordered:""},{default:d(()=>[i(A,null,{default:d(()=>[o("div",rt,[i(G,{name:"mdi-folder",color:"primary",class:"q-mr-sm"}),o("span",st,D(l.name),1)]),o("div",it," ID: "+D(l.id),1),l.description?(x(),T("div",at,D(l.description),1)):S("",!0)]),_:2},1024)]),_:2},1024)]))),128))])]),_:1,__:[12,13]})]),_:1})]),o("div",nt,[i(E,null,{default:d(()=>[i(A,null,{default:d(()=>[t[14]||(t[14]=o("div",{class:"text-h6"},"Available Google Drive Content",-1)),t[15]||(t[15]=o("div",{class:"text-subtitle2 text-grey-7 q-mb-md"}," Access working Google Drive content management ",-1)),o("div",lt,[i(_,{color:"primary",label:"Google Drive Content Dashboard",onClick:t[0]||(t[0]=l=>c.$router.push("/google-drive-content"))}),i(_,{color:"secondary",outline:"",label:"View Documentation",onClick:h})])]),_:1,__:[14,15]})]),_:1})]),o("div",ct,[i(E,null,{default:d(()=>[i(A,null,{default:d(()=>t[16]||(t[16]=[o("div",{class:"text-h6"},"✅ Implementation Complete",-1),o("div",{class:"q-mt-md"},[o("p",{class:"text-body1"}," The Google Drive integration has been fully restored and is now operational! All core components are ready for use: "),o("div",{class:"q-mt-md"},[o("div",{class:"text-weight-medium q-mb-sm"},"✅ Completed Tasks:"),o("ul",{class:"q-pl-md"},[o("li",null,[w("✅ Restored "),o("code",null,"useGoogleDrive.ts"),w(" composable")]),o("li",null,[w("✅ Implemented "),o("code",null,"GoogleDriveImageBrowser.vue"),w(" component")]),o("li",null,[w("✅ Completed "),o("code",null,"useExternalImageWithGoogleDrive.ts"),w(" composable")]),o("li",null,[w("✅ Created "),o("code",null,"GoogleDriveBrowserService"),w(" for browser compatibility")]),o("li",null,"✅ Full demo functionality now available")])]),o("div",{class:"q-mt-md"},[o("div",{class:"text-weight-medium q-mb-sm"},"Environment Configured:"),o("ul",{class:"q-pl-md"},[o("li",null,"✅ Google Cloud Console project setup"),o("li",null,"✅ Google Drive API enabled"),o("li",null,"✅ OAuth 2.0 credentials configured"),o("li",null,"✅ Environment variables in .env file"),o("li",null,"✅ Google Drive folder IDs configured")])])],-1)])),_:1,__:[16]})]),_:1})]),o("div",ut,[i(E,null,{default:d(()=>[i(A,null,{default:d(()=>[t[18]||(t[18]=o("div",{class:"text-h6"},"🎯 Live Google Drive Integration Demo",-1)),o("div",dt,[t[17]||(t[17]=o("p",{class:"text-body1"}," Try the fully restored Google Drive image browser below. You can authenticate, browse folders, and view images directly from Google Drive: ",-1)),o("div",mt,[i(Re)])])]),_:1,__:[18]})]),_:1})])]),_:1,__:[19]}))}});export{At as default};
